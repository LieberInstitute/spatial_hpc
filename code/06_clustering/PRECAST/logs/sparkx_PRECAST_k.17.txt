**** Job starts ****
Thu May 18 18:43:21 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3172459
Job name: sparkx_PRECAST_k15-20
Hostname: compute-065.cm.cluster
Task id: 17
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

**** Job starts ****
Fri May 19 01:43:42 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3172462
Job name: sparkx_PRECAST_k15-20
Hostname: compute-124.cm.cluster
Task id: 17
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
diff Energy = 76.488039 
Finish ICM step! 
iter = 2, loglik= 106498128.000000, dloglik=1.049592 
predict Y and V! 
diff Energy = 69.865631 
diff Energy = 36.190230 
diff Energy = 36.588018 
Finish ICM step! 
iter = 3, loglik= 107182664.000000, dloglik=0.006428 
predict Y and V! 
diff Energy = 111.491751 
diff Energy = 173.940145 
diff Energy = 71.704603 
diff Energy = 100.160524 
diff Energy = 104.801767 
diff Energy = 137.559975 
diff Energy = 69.058685 
diff Energy = 47.069396 
diff Energy = 155.104879 
diff Energy = 81.899652 
Finish ICM step! 
iter = 4, loglik= 107438616.000000, dloglik=0.002388 
predict Y and V! 
diff Energy = 54.890840 
diff Energy = 269.730342 
diff Energy = 16.951820 
diff Energy = 18.905506 
diff Energy = 128.203814 
diff Energy = 50.994798 
diff Energy = 13.608684 
diff Energy = 46.585495 
diff Energy = 200.559729 
diff Energy = 51.375044 
Finish ICM step! 
iter = 5, loglik= 107556648.000000, dloglik=0.001099 
predict Y and V! 
diff Energy = 50.683601 
diff Energy = 286.908134 
diff Energy = 0.145724 
diff Energy = 48.031681 
diff Energy = 144.814527 
diff Energy = 45.330518 
diff Energy = 17.681683 
diff Energy = 40.759695 
diff Energy = 153.420769 
diff Energy = 128.096621 
Finish ICM step! 
iter = 6, loglik= 107625040.000000, dloglik=0.000636 
predict Y and V! 
diff Energy = 143.426224 
diff Energy = 226.911307 
diff Energy = 16.678337 
diff Energy = 43.112473 
diff Energy = 152.805668 
diff Energy = 73.693162 
diff Energy = 66.893756 
diff Energy = 59.361698 
diff Energy = 225.996152 
diff Energy = 137.896784 
Finish ICM step! 
iter = 7, loglik= 107668264.000000, dloglik=0.000402 
predict Y and V! 
diff Energy = 104.223646 
diff Energy = 188.613471 
diff Energy = 24.177409 
diff Energy = 63.698561 
diff Energy = 139.653016 
diff Energy = 61.228439 
diff Energy = 68.106574 
diff Energy = 55.558814 
diff Energy = 164.652449 
diff Energy = 131.948196 
Finish ICM step! 
iter = 8, loglik= 107698576.000000, dloglik=0.000282 
predict Y and V! 
diff Energy = 103.477139 
diff Energy = 298.399312 
diff Energy = 2.503510 
diff Energy = 40.449655 
diff Energy = 104.018931 
diff Energy = 51.870877 
diff Energy = 84.989718 
diff Energy = 42.684440 
diff Energy = 158.283730 
diff Energy = 102.400055 
Finish ICM step! 
iter = 9, loglik= 107722016.000000, dloglik=0.000218 
predict Y and V! 
diff Energy = 94.391790 
diff Energy = 156.932815 
diff Energy = 2.503196 
diff Energy = 35.277669 
diff Energy = 106.780360 
diff Energy = 128.556793 
diff Energy = 189.538251 
diff Energy = 38.812504 
diff Energy = 254.308596 
diff Energy = 98.869951 
Finish ICM step! 
iter = 10, loglik= 107742064.000000, dloglik=0.000186 
predict Y and V! 
diff Energy = 170.998724 
diff Energy = 158.477877 
diff Energy = 21.548971 
diff Energy = 39.761365 
diff Energy = 104.677395 
diff Energy = 40.456575 
diff Energy = 133.166551 
diff Energy = 48.746811 
diff Energy = 127.400416 
diff Energy = 80.698334 
Finish ICM step! 
iter = 11, loglik= 107760144.000000, dloglik=0.000168 
predict Y and V! 
diff Energy = 105.168814 
diff Energy = 167.519057 
diff Energy = 14.239006 
diff Energy = 57.958435 
diff Energy = 82.264336 
diff Energy = 44.157158 
diff Energy = 89.143848 
diff Energy = 88.909430 
diff Energy = 91.728621 
diff Energy = 63.892667 
Finish ICM step! 
iter = 12, loglik= 107777312.000000, dloglik=0.000159 
predict Y and V! 
diff Energy = 63.211000 
diff Energy = 361.529295 
diff Energy = 134.633010 
diff Energy = 35.992959 
diff Energy = 96.215826 
diff Energy = 28.066586 
diff Energy = 132.261807 
diff Energy = 36.882390 
diff Energy = 108.293295 
diff Energy = 194.422610 
Finish ICM step! 
iter = 13, loglik= 107793664.000000, dloglik=0.000152 
predict Y and V! 
diff Energy = 75.619514 
diff Energy = 114.329887 
diff Energy = 48.839753 
diff Energy = 45.997520 
diff Energy = 103.989266 
diff Energy = 50.279227 
diff Energy = 292.840806 
diff Energy = 18.916727 
diff Energy = 99.539783 
diff Energy = 90.842818 
Finish ICM step! 
iter = 14, loglik= 107810360.000000, dloglik=0.000155 
predict Y and V! 
diff Energy = 83.733157 
diff Energy = 135.702595 
diff Energy = 42.914903 
diff Energy = 138.525037 
diff Energy = 246.319725 
diff Energy = 203.170003 
diff Energy = 90.163853 
diff Energy = 8.906236 
diff Energy = 59.976182 
diff Energy = 58.767731 
Finish ICM step! 
iter = 15, loglik= 107827384.000000, dloglik=0.000158 
predict Y and V! 
diff Energy = 181.190760 
diff Energy = 130.736802 
diff Energy = 63.623961 
diff Energy = 30.386396 
diff Energy = 144.480420 
diff Energy = 70.744170 
diff Energy = 92.548918 
diff Energy = 24.896387 
diff Energy = 287.237486 
diff Energy = 59.994985 
Finish ICM step! 
iter = 16, loglik= 107844760.000000, dloglik=0.000161 
predict Y and V! 
diff Energy = 68.365934 
diff Energy = 112.215484 
diff Energy = 52.852584 
diff Energy = 12.030388 
diff Energy = 172.099805 
diff Energy = 54.473885 
diff Energy = 89.345732 
diff Energy = 31.878473 
diff Energy = 75.569748 
diff Energy = 87.360290 
Finish ICM step! 
iter = 17, loglik= 107862240.000000, dloglik=0.000162 
predict Y and V! 
diff Energy = 79.506930 
diff Energy = 115.454273 
diff Energy = 148.464294 
diff Energy = 45.720176 
diff Energy = 123.544395 
diff Energy = 76.793505 
diff Energy = 102.542183 
diff Energy = 105.131995 
diff Energy = 105.169036 
diff Energy = 230.677167 
Finish ICM step! 
iter = 18, loglik= 107879200.000000, dloglik=0.000157 
predict Y and V! 
diff Energy = 77.420498 
diff Energy = 431.392774 
diff Energy = 61.367648 
diff Energy = 36.979148 
diff Energy = 389.915642 
diff Energy = 82.496815 
diff Energy = 387.694279 
diff Energy = 53.127447 
diff Energy = 115.001736 
diff Energy = 120.832508 
Finish ICM step! 
iter = 19, loglik= 107895840.000000, dloglik=0.000154 
predict Y and V! 
diff Energy = 81.505221 
diff Energy = 82.292881 
diff Energy = 27.936240 
diff Energy = 55.936889 
diff Energy = 156.012913 
diff Energy = 49.813852 
diff Energy = 75.454960 
diff Energy = 68.591457 
diff Energy = 111.027965 
diff Energy = 106.133530 
Finish ICM step! 
iter = 20, loglik= 107913008.000000, dloglik=0.000159 
predict Y and V! 
diff Energy = 89.315563 
diff Energy = 142.623429 
diff Energy = 67.662010 
diff Energy = 52.218989 
diff Energy = 153.970395 
diff Energy = 241.244621 
diff Energy = 183.631913 
diff Energy = 57.324456 
diff Energy = 375.161705 
diff Energy = 73.183012 
Finish ICM step! 
iter = 21, loglik= 107930400.000000, dloglik=0.000161 
predict Y and V! 
diff Energy = 78.726354 
diff Energy = 92.957901 
diff Energy = 78.792007 
diff Energy = 173.049750 
diff Energy = 131.362975 
diff Energy = 82.702558 
diff Energy = 177.452632 
diff Energy = 57.249853 
diff Energy = 158.654940 
diff Energy = 99.781149 
Finish ICM step! 
iter = 22, loglik= 107950152.000000, dloglik=0.000183 
predict Y and V! 
diff Energy = 238.722137 
diff Energy = 135.076551 
diff Energy = 89.746242 
diff Energy = 78.035446 
diff Energy = 137.587918 
diff Energy = 84.045831 
diff Energy = 128.936923 
diff Energy = 77.494323 
diff Energy = 161.657965 
diff Energy = 328.185333 
Finish ICM step! 
iter = 23, loglik= 107973760.000000, dloglik=0.000219 
predict Y and V! 
diff Energy = 108.835016 
diff Energy = 63.244843 
diff Energy = 217.851784 
diff Energy = 84.932539 
diff Energy = 230.711041 
diff Energy = 109.091678 
diff Energy = 441.657456 
diff Energy = 165.420837 
diff Energy = 142.253680 
diff Energy = 128.919851 
Finish ICM step! 
iter = 24, loglik= 108005968.000000, dloglik=0.000298 
predict Y and V! 
diff Energy = 141.773660 
diff Energy = 76.985481 
diff Energy = 98.358081 
diff Energy = 118.885772 
diff Energy = 127.502625 
diff Energy = 89.956719 
diff Energy = 160.943030 
diff Energy = 94.718775 
diff Energy = 153.355877 
diff Energy = 150.165156 
Finish ICM step! 
iter = 25, loglik= 108054912.000000, dloglik=0.000453 
predict Y and V! 
diff Energy = 112.967990 
diff Energy = 22.147823 
diff Energy = 71.349027 
diff Energy = 258.954686 
diff Energy = 73.544971 
diff Energy = 318.315098 
diff Energy = 134.636979 
diff Energy = 72.526990 
diff Energy = 402.372113 
diff Energy = 91.065781 
Finish ICM step! 
iter = 26, loglik= 108129296.000000, dloglik=0.000688 
predict Y and V! 
diff Energy = 153.812261 
diff Energy = 21.415687 
diff Energy = 111.685607 
diff Energy = 91.621310 
diff Energy = 0.247239 
diff Energy = 245.834394 
diff Energy = 96.851688 
diff Energy = 109.313065 
diff Energy = 167.178906 
diff Energy = 61.398605 
Finish ICM step! 
iter = 27, loglik= 108224392.000000, dloglik=0.000879 
predict Y and V! 
diff Energy = 329.732269 
diff Energy = 27.796024 
diff Energy = 110.041478 
diff Energy = 66.824666 
diff Energy = 64.364326 
diff Energy = 194.241459 
diff Energy = 32.547035 
diff Energy = 169.620794 
diff Energy = 108.908464 
diff Energy = 238.963549 
Finish ICM step! 
iter = 28, loglik= 108328024.000000, dloglik=0.000958 
predict Y and V! 
diff Energy = 148.644942 
diff Energy = 38.860571 
diff Energy = 55.122747 
diff Energy = 49.100500 
diff Energy = 39.268200 
diff Energy = 171.531849 
diff Energy = 53.107241 
diff Energy = 41.851162 
diff Energy = 40.177333 
diff Energy = 52.160223 
Finish ICM step! 
iter = 29, loglik= 108441480.000000, dloglik=0.001047 
predict Y and V! 
diff Energy = 98.349174 
diff Energy = 20.769755 
diff Energy = 181.219582 
diff Energy = 29.975068 
diff Energy = 350.847283 
diff Energy = 11.061348 
diff Energy = 35.546850 
diff Energy = 97.881517 
diff Energy = 20.480718 
Finish ICM step! 
iter = 30, loglik= 108572400.000000, dloglik=0.001207 
10761.779 sec elapsed
**** Job ends ****
Fri May 19 04:53:41 EDT 2023
