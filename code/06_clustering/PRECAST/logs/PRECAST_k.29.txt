**** Job starts ****
Thu Apr  6 22:10:22 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100765
Job name: PRECAST_k25-30
Hostname: compute-098.cm.cluster
Task id: 29
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
Finish ICM step! 
iter = 2, loglik= 106507440.000000, dloglik=1.049596 
predict Y and V! 
Finish ICM step! 
iter = 3, loglik= 107191936.000000, dloglik=0.006427 
predict Y and V! 
diff Energy = 63.626850 
diff Energy = 125.808886 
diff Energy = 1.361706 
diff Energy = 32.465095 
diff Energy = 152.929491 
diff Energy = 96.483966 
diff Energy = 184.021745 
diff Energy = 72.720373 
diff Energy = 1.095975 
diff Energy = 119.730171 
Finish ICM step! 
iter = 4, loglik= 107450376.000000, dloglik=0.002411 
predict Y and V! 
diff Energy = 89.099581 
diff Energy = 165.229838 
diff Energy = 16.548216 
diff Energy = 67.983134 
diff Energy = 213.432208 
diff Energy = 7.275344 
diff Energy = 142.649617 
diff Energy = 68.785532 
diff Energy = 72.407434 
diff Energy = 14.766304 
Finish ICM step! 
iter = 5, loglik= 107572336.000000, dloglik=0.001135 
predict Y and V! 
diff Energy = 256.724217 
diff Energy = 329.430887 
diff Energy = 101.162313 
diff Energy = 141.930107 
diff Energy = 224.930033 
diff Energy = 231.999014 
diff Energy = 168.883623 
diff Energy = 91.359550 
diff Energy = 49.459938 
diff Energy = 250.385664 
Finish ICM step! 
iter = 6, loglik= 107641848.000000, dloglik=0.000646 
predict Y and V! 
diff Energy = 245.153361 
diff Energy = 289.901309 
diff Energy = 120.045109 
diff Energy = 150.979218 
diff Energy = 349.499881 
diff Energy = 263.112353 
diff Energy = 346.767151 
diff Energy = 138.568704 
diff Energy = 231.694966 
diff Energy = 306.413724 
Finish ICM step! 
iter = 7, loglik= 107686264.000000, dloglik=0.000413 
predict Y and V! 
diff Energy = 228.639826 
diff Energy = 256.267642 
diff Energy = 280.557048 
diff Energy = 139.656199 
diff Energy = 538.840829 
diff Energy = 294.915642 
diff Energy = 271.069898 
diff Energy = 341.246285 
diff Energy = 237.723171 
diff Energy = 306.920187 
Finish ICM step! 
iter = 8, loglik= 107718704.000000, dloglik=0.000301 
predict Y and V! 
diff Energy = 212.211943 
diff Energy = 467.639448 
diff Energy = 130.065155 
diff Energy = 133.234513 
diff Energy = 304.359141 
diff Energy = 254.916727 
diff Energy = 560.745265 
diff Energy = 167.394339 
diff Energy = 471.318862 
diff Energy = 553.331566 
Finish ICM step! 
iter = 9, loglik= 107745416.000000, dloglik=0.000248 
predict Y and V! 
diff Energy = 425.591483 
diff Energy = 204.965005 
diff Energy = 178.886273 
diff Energy = 134.522798 
diff Energy = 321.937869 
diff Energy = 497.263813 
diff Energy = 344.449328 
diff Energy = 343.988964 
diff Energy = 297.143754 
diff Energy = 284.329670 
Finish ICM step! 
iter = 10, loglik= 107770488.000000, dloglik=0.000233 
predict Y and V! 
diff Energy = 184.811398 
diff Energy = 258.726441 
diff Energy = 303.023680 
diff Energy = 298.279620 
diff Energy = 541.385592 
diff Energy = 282.159303 
diff Energy = 669.801303 
diff Energy = 125.797856 
diff Energy = 302.155356 
diff Energy = 275.155029 
Finish ICM step! 
iter = 11, loglik= 107795304.000000, dloglik=0.000230 
predict Y and V! 
diff Energy = 193.073943 
diff Energy = 423.122170 
diff Energy = 188.131686 
diff Energy = 132.941432 
diff Energy = 281.084661 
diff Energy = 626.280312 
diff Energy = 294.829296 
diff Energy = 174.065027 
diff Energy = 575.870329 
diff Energy = 481.311926 
Finish ICM step! 
iter = 12, loglik= 107821568.000000, dloglik=0.000244 
predict Y and V! 
diff Energy = 420.617152 
diff Energy = 166.487052 
diff Energy = 162.667964 
diff Energy = 151.813893 
diff Energy = 391.761176 
diff Energy = 359.057022 
diff Energy = 303.584191 
diff Energy = 238.314404 
diff Energy = 333.200148 
diff Energy = 282.016995 
Finish ICM step! 
iter = 13, loglik= 107850320.000000, dloglik=0.000267 
predict Y and V! 
diff Energy = 189.115121 
diff Energy = 191.019838 
diff Energy = 330.940032 
diff Energy = 285.386760 
diff Energy = 172.395661 
diff Energy = 520.179077 
diff Energy = 560.220078 
diff Energy = 92.484023 
diff Energy = 286.364030 
diff Energy = 350.993909 
Finish ICM step! 
iter = 14, loglik= 107882376.000000, dloglik=0.000297 
predict Y and V! 
diff Energy = 156.051416 
diff Energy = 193.384655 
diff Energy = 143.130624 
diff Energy = 135.926808 
diff Energy = 108.899412 
diff Energy = 160.816829 
diff Energy = 206.585384 
diff Energy = 75.410893 
diff Energy = 519.505458 
diff Energy = 223.413159 
Finish ICM step! 
iter = 15, loglik= 107918456.000000, dloglik=0.000334 
predict Y and V! 
diff Energy = 264.835035 
diff Energy = 64.645984 
diff Energy = 138.358787 
diff Energy = 82.853297 
diff Energy = 238.894676 
diff Energy = 145.968384 
diff Energy = 146.702279 
diff Energy = 57.691517 
diff Energy = 257.396357 
diff Energy = 103.856987 
Finish ICM step! 
iter = 16, loglik= 107957768.000000, dloglik=0.000364 
predict Y and V! 
diff Energy = 108.546232 
diff Energy = 298.156603 
diff Energy = 316.729682 
diff Energy = 173.950902 
diff Energy = 51.875549 
diff Energy = 86.049625 
diff Energy = 85.740972 
diff Energy = 149.914952 
diff Energy = 181.495801 
diff Energy = 120.524746 
Finish ICM step! 
iter = 17, loglik= 107999224.000000, dloglik=0.000384 
predict Y and V! 
diff Energy = 133.020820 
diff Energy = 150.088863 
diff Energy = 154.059944 
diff Energy = 33.161511 
diff Energy = 95.008009 
diff Energy = 207.122674 
diff Energy = 256.548232 
diff Energy = 37.478208 
diff Energy = 312.700997 
diff Energy = 174.471307 
Finish ICM step! 
iter = 18, loglik= 108042040.000000, dloglik=0.000396 
predict Y and V! 
diff Energy = 67.465928 
diff Energy = 81.197277 
diff Energy = 97.811604 
diff Energy = 50.516577 
diff Energy = 83.084543 
diff Energy = 103.911952 
diff Energy = 81.740659 
diff Energy = 34.960976 
diff Energy = 125.091391 
diff Energy = 62.692888 
Finish ICM step! 
iter = 19, loglik= 108085416.000000, dloglik=0.000401 
predict Y and V! 
diff Energy = 91.526657 
diff Energy = 28.961810 
diff Energy = 30.958471 
diff Energy = 53.937590 
diff Energy = 31.316954 
diff Energy = 94.721513 
diff Energy = 104.470469 
diff Energy = 33.264892 
diff Energy = 153.982211 
diff Energy = 74.028000 
Finish ICM step! 
iter = 20, loglik= 108127968.000000, dloglik=0.000394 
predict Y and V! 
diff Energy = 36.755504 
diff Energy = 80.144871 
diff Energy = 218.747063 
diff Energy = 34.454475 
diff Energy = 58.823280 
diff Energy = 89.357038 
diff Energy = 66.924444 
diff Energy = 42.150097 
diff Energy = 60.247023 
diff Energy = 56.576493 
Finish ICM step! 
iter = 21, loglik= 108169656.000000, dloglik=0.000386 
predict Y and V! 
diff Energy = 63.311033 
diff Energy = 53.024124 
diff Energy = 71.942625 
diff Energy = 51.585917 
diff Energy = 10.609732 
diff Energy = 35.638571 
diff Energy = 52.582805 
diff Energy = 21.696179 
diff Energy = 66.599188 
diff Energy = 65.687099 
Finish ICM step! 
iter = 22, loglik= 108212312.000000, dloglik=0.000394 
predict Y and V! 
diff Energy = 51.054057 
diff Energy = 32.459693 
diff Energy = 85.517374 
diff Energy = 39.762311 
diff Energy = 48.399128 
diff Energy = 44.439924 
diff Energy = 20.762475 
diff Energy = 9.932751 
diff Energy = 28.004156 
diff Energy = 34.293349 
Finish ICM step! 
iter = 23, loglik= 108260088.000000, dloglik=0.000442 
predict Y and V! 
diff Energy = 14.962243 
diff Energy = 39.240171 
diff Energy = 39.731240 
diff Energy = 26.487525 
diff Energy = 27.763459 
diff Energy = 49.544903 
diff Energy = 8.566484 
diff Energy = 22.738990 
diff Energy = 49.840470 
Finish ICM step! 
iter = 24, loglik= 108322984.000000, dloglik=0.000581 
predict Y and V! 
diff Energy = 30.653631 
diff Energy = 41.016870 
diff Energy = 48.155072 
diff Energy = 17.936320 
diff Energy = 25.585159 
diff Energy = 33.639154 
diff Energy = 77.740416 
diff Energy = 15.295194 
diff Energy = 50.490739 
diff Energy = 16.581509 
Finish ICM step! 
iter = 25, loglik= 108406896.000000, dloglik=0.000775 
predict Y and V! 
diff Energy = 36.397259 
diff Energy = 41.471852 
diff Energy = 23.996771 
diff Energy = 34.762697 
diff Energy = 26.222093 
diff Energy = 15.946254 
diff Energy = 67.062592 
diff Energy = 8.428066 
diff Energy = 52.749996 
diff Energy = 22.752882 
Finish ICM step! 
iter = 26, loglik= 108497608.000000, dloglik=0.000837 
predict Y and V! 
diff Energy = 22.121306 
diff Energy = 21.691491 
diff Energy = 60.814778 
diff Energy = 15.916919 
diff Energy = 6.843876 
diff Energy = 38.620059 
diff Energy = 18.631978 
diff Energy = 46.676972 
diff Energy = 27.761134 
Finish ICM step! 
iter = 27, loglik= 108585296.000000, dloglik=0.000808 
predict Y and V! 
diff Energy = 30.309127 
diff Energy = 21.676690 
diff Energy = 21.395329 
diff Energy = 3.552147 
diff Energy = 2.723382 
diff Energy = 14.025344 
diff Energy = 16.885114 
diff Energy = 24.259537 
diff Energy = 121.475680 
diff Energy = 27.687913 
Finish ICM step! 
iter = 28, loglik= 108671592.000000, dloglik=0.000795 
predict Y and V! 
diff Energy = 3.915569 
diff Energy = 27.419702 
diff Energy = 10.946181 
diff Energy = 9.139114 
diff Energy = 26.793273 
diff Energy = 6.319607 
diff Energy = 1.383603 
diff Energy = 8.788510 
diff Energy = 2.210503 
diff Energy = 21.668111 
Finish ICM step! 
iter = 29, loglik= 108760320.000000, dloglik=0.000816 
predict Y and V! 
diff Energy = 8.409761 
diff Energy = 3.189242 
diff Energy = 10.637957 
diff Energy = 1.860214 
diff Energy = 2.182635 
diff Energy = 7.005461 
diff Energy = 18.627929 
diff Energy = 0.333894 
diff Energy = 35.076976 
diff Energy = 16.410410 
Finish ICM step! 
iter = 30, loglik= 108861336.000000, dloglik=0.000929 
32344.932 sec elapsed
**** Job ends ****
Fri Apr  7 07:30:57 EDT 2023
