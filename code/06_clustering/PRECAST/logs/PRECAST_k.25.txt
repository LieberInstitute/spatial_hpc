**** Job starts ****
Thu Apr  6 13:02:18 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100763
Job name: PRECAST_k25-30
Hostname: compute-097.cm.cluster
Task id: 25
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

**** Job starts ****
Thu Apr  6 13:04:02 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100765
Job name: PRECAST_k25-30
Hostname: compute-097.cm.cluster
Task id: 25
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
Finish ICM step! 
iter = 2, loglik= 106505312.000000, dloglik=1.049595 
predict Y and V! 
diff Energy = 23.432953 
diff Energy = 25.394975 
Finish ICM step! 
iter = 3, loglik= 107191888.000000, dloglik=0.006446 
predict Y and V! 
diff Energy = 62.257909 
diff Energy = 184.268196 
diff Energy = 129.788511 
diff Energy = 34.437291 
diff Energy = 73.073938 
diff Energy = 116.459101 
diff Energy = 173.388058 
diff Energy = 87.309177 
diff Energy = 88.958377 
diff Energy = 205.739050 
Finish ICM step! 
iter = 4, loglik= 107449496.000000, dloglik=0.002403 
predict Y and V! 
diff Energy = 83.910185 
diff Energy = 179.844886 
diff Energy = 71.537620 
diff Energy = 46.772628 
diff Energy = 87.836458 
diff Energy = 118.278036 
diff Energy = 115.601019 
diff Energy = 188.454844 
diff Energy = 81.513732 
diff Energy = 319.352920 
Finish ICM step! 
iter = 5, loglik= 107569304.000000, dloglik=0.001115 
predict Y and V! 
diff Energy = 129.186074 
diff Energy = 272.512784 
diff Energy = 103.180927 
diff Energy = 52.504567 
diff Energy = 222.303087 
diff Energy = 115.134108 
diff Energy = 308.551842 
diff Energy = 242.029053 
diff Energy = 262.472960 
diff Energy = 255.002331 
Finish ICM step! 
iter = 6, loglik= 107637360.000000, dloglik=0.000633 
predict Y and V! 
diff Energy = 205.973001 
diff Energy = 262.640548 
diff Energy = 168.166111 
diff Energy = 91.584702 
diff Energy = 281.211138 
diff Energy = 240.761419 
diff Energy = 312.292908 
diff Energy = 220.611457 
diff Energy = 285.891123 
diff Energy = 361.033570 
Finish ICM step! 
iter = 7, loglik= 107681744.000000, dloglik=0.000412 
predict Y and V! 
diff Energy = 216.641013 
diff Energy = 490.956226 
diff Energy = 147.198678 
diff Energy = 111.496317 
diff Energy = 252.714371 
diff Energy = 224.360121 
diff Energy = 254.707396 
diff Energy = 165.844388 
diff Energy = 267.459467 
diff Energy = 572.945431 
Finish ICM step! 
iter = 8, loglik= 107713960.000000, dloglik=0.000299 
predict Y and V! 
diff Energy = 204.548237 
diff Energy = 263.933487 
diff Energy = 136.282492 
diff Energy = 103.517234 
diff Energy = 184.599630 
diff Energy = 445.163808 
diff Energy = 300.008914 
diff Energy = 157.260530 
diff Energy = 282.656854 
diff Energy = 336.880269 
Finish ICM step! 
iter = 9, loglik= 107740432.000000, dloglik=0.000246 
predict Y and V! 
diff Energy = 412.997617 
diff Energy = 184.583858 
diff Energy = 231.235008 
diff Energy = 124.018012 
diff Energy = 471.342592 
diff Energy = 226.910342 
diff Energy = 270.630152 
diff Energy = 289.337366 
diff Energy = 265.008595 
diff Energy = 294.463968 
Finish ICM step! 
iter = 10, loglik= 107764168.000000, dloglik=0.000220 
predict Y and V! 
diff Energy = 202.456697 
diff Energy = 488.157085 
diff Energy = 145.882341 
diff Energy = 265.529813 
diff Energy = 250.744558 
diff Energy = 270.539982 
diff Energy = 516.999158 
diff Energy = 167.065947 
diff Energy = 478.390772 
diff Energy = 545.768265 
Finish ICM step! 
iter = 11, loglik= 107787288.000000, dloglik=0.000215 
predict Y and V! 
diff Energy = 244.609366 
diff Energy = 206.059702 
diff Energy = 134.468824 
diff Energy = 112.730146 
diff Energy = 431.918345 
diff Energy = 533.755199 
diff Energy = 246.948368 
diff Energy = 114.744006 
diff Energy = 283.100435 
diff Energy = 257.771151 
Finish ICM step! 
iter = 12, loglik= 107811432.000000, dloglik=0.000224 
predict Y and V! 
diff Energy = 385.629065 
diff Energy = 176.384910 
diff Energy = 362.016414 
diff Energy = 290.447137 
diff Energy = 212.708621 
diff Energy = 305.754308 
diff Energy = 519.135295 
diff Energy = 280.363656 
diff Energy = 302.184949 
diff Energy = 216.171929 
Finish ICM step! 
iter = 13, loglik= 107836680.000000, dloglik=0.000234 
predict Y and V! 
diff Energy = 224.679579 
diff Energy = 188.982685 
diff Energy = 162.924363 
diff Energy = 173.519492 
diff Energy = 183.886020 
diff Energy = 548.254517 
diff Energy = 184.946095 
diff Energy = 133.041895 
diff Energy = 529.575037 
diff Energy = 423.113951 
Finish ICM step! 
iter = 14, loglik= 107864224.000000, dloglik=0.000255 
predict Y and V! 
diff Energy = 142.381478 
diff Energy = 466.671549 
diff Energy = 135.549292 
diff Energy = 105.466556 
diff Energy = 181.981455 
diff Energy = 233.213082 
diff Energy = 222.247830 
diff Energy = 137.080896 
diff Energy = 277.248008 
diff Energy = 125.594034 
Finish ICM step! 
iter = 15, loglik= 107894784.000000, dloglik=0.000283 
predict Y and V! 
diff Energy = 321.082220 
diff Energy = 126.470981 
diff Energy = 381.054818 
diff Energy = 283.860153 
diff Energy = 323.987630 
diff Energy = 177.566983 
diff Energy = 228.231967 
diff Energy = 223.460126 
diff Energy = 271.411546 
diff Energy = 195.533278 
Finish ICM step! 
iter = 16, loglik= 107927816.000000, dloglik=0.000306 
predict Y and V! 
diff Energy = 142.820443 
diff Energy = 182.806089 
diff Energy = 162.643994 
diff Energy = 88.850357 
diff Energy = 105.220891 
diff Energy = 391.554405 
diff Energy = 357.237605 
diff Energy = 77.826023 
diff Energy = 458.320036 
diff Energy = 268.524954 
Finish ICM step! 
iter = 17, loglik= 107964312.000000, dloglik=0.000338 
predict Y and V! 
diff Energy = 129.755079 
diff Energy = 124.214513 
diff Energy = 149.936251 
diff Energy = 61.573259 
diff Energy = 110.860751 
diff Energy = 144.382661 
diff Energy = 97.215767 
diff Energy = 67.615736 
diff Energy = 138.256256 
diff Energy = 167.181679 
Finish ICM step! 
iter = 18, loglik= 108004672.000000, dloglik=0.000374 
predict Y and V! 
diff Energy = 89.373209 
diff Energy = 37.196449 
diff Energy = 101.765979 
diff Energy = 75.601314 
diff Energy = 85.497799 
diff Energy = 83.042781 
diff Energy = 57.282464 
diff Energy = 178.627727 
diff Energy = 60.107856 
Finish ICM step! 
iter = 19, loglik= 108046296.000000, dloglik=0.000385 
predict Y and V! 
diff Energy = 118.803739 
diff Energy = 27.644956 
diff Energy = 242.776346 
diff Energy = 33.815978 
diff Energy = 32.309361 
diff Energy = 78.899900 
diff Energy = 127.026131 
diff Energy = 32.190072 
diff Energy = 102.630891 
diff Energy = 105.270313 
Finish ICM step! 
iter = 20, loglik= 108086560.000000, dloglik=0.000373 
predict Y and V! 
diff Energy = 57.630379 
diff Energy = 34.682373 
diff Energy = 54.726185 
diff Energy = 68.329508 
diff Energy = 64.476997 
diff Energy = 90.567868 
diff Energy = 38.013724 
diff Energy = 32.040845 
diff Energy = 98.354131 
diff Energy = 51.118889 
Finish ICM step! 
iter = 21, loglik= 108125592.000000, dloglik=0.000361 
predict Y and V! 
diff Energy = 162.578455 
diff Energy = 22.183280 
diff Energy = 79.921467 
diff Energy = 43.019619 
diff Energy = 44.647817 
diff Energy = 40.847133 
diff Energy = 24.436479 
diff Energy = 52.675629 
diff Energy = 150.055459 
diff Energy = 72.776397 
Finish ICM step! 
iter = 22, loglik= 108164544.000000, dloglik=0.000360 
predict Y and V! 
diff Energy = 28.634070 
diff Energy = 43.811538 
diff Energy = 31.921879 
diff Energy = 32.242807 
diff Energy = 43.869252 
diff Energy = 37.320902 
diff Energy = 74.928736 
diff Energy = 22.572081 
diff Energy = 44.417600 
diff Energy = 37.226439 
Finish ICM step! 
iter = 23, loglik= 108205496.000000, dloglik=0.000379 
predict Y and V! 
diff Energy = 54.769501 
diff Energy = 6.713332 
diff Energy = 29.151358 
diff Energy = 27.753744 
diff Energy = 104.356556 
diff Energy = 32.016711 
diff Energy = 31.666864 
diff Energy = 23.115425 
diff Energy = 49.738160 
diff Energy = 47.745454 
Finish ICM step! 
iter = 24, loglik= 108254224.000000, dloglik=0.000450 
predict Y and V! 
diff Energy = 7.588767 
diff Energy = 56.994559 
diff Energy = 30.159561 
diff Energy = 45.795617 
diff Energy = 35.701103 
diff Energy = 36.711829 
diff Energy = 33.827010 
diff Energy = 11.953821 
diff Energy = 26.866966 
diff Energy = 56.533289 
Finish ICM step! 
iter = 25, loglik= 108321264.000000, dloglik=0.000619 
predict Y and V! 
diff Energy = 17.829022 
diff Energy = 29.233654 
diff Energy = 28.636079 
diff Energy = 39.295262 
diff Energy = 18.299306 
diff Energy = 176.369032 
diff Energy = 10.883127 
diff Energy = 37.473773 
diff Energy = 30.989177 
Finish ICM step! 
iter = 26, loglik= 108406584.000000, dloglik=0.000788 
predict Y and V! 
diff Energy = 18.926739 
diff Energy = 49.425467 
diff Energy = 5.122286 
diff Energy = 1.694533 
diff Energy = 40.009772 
diff Energy = 62.427644 
diff Energy = 42.539472 
diff Energy = 17.978854 
diff Energy = 33.955275 
diff Energy = 32.546074 
Finish ICM step! 
iter = 27, loglik= 108493752.000000, dloglik=0.000804 
predict Y and V! 
diff Energy = 35.268525 
diff Energy = 21.669001 
diff Energy = 9.979578 
diff Energy = 7.055794 
diff Energy = 26.846808 
diff Energy = 37.968392 
diff Energy = 76.609981 
diff Energy = 7.538910 
diff Energy = 54.892462 
diff Energy = 86.981184 
Finish ICM step! 
iter = 28, loglik= 108577312.000000, dloglik=0.000770 
predict Y and V! 
diff Energy = 26.085469 
diff Energy = 55.471131 
diff Energy = 19.007300 
diff Energy = 24.762484 
diff Energy = 21.878205 
diff Energy = 144.451578 
diff Energy = 35.100922 
diff Energy = 26.583788 
diff Energy = 28.051811 
diff Energy = 26.019331 
Finish ICM step! 
iter = 29, loglik= 108663984.000000, dloglik=0.000798 
predict Y and V! 
diff Energy = 24.856349 
diff Energy = 9.710989 
diff Energy = 5.838523 
diff Energy = 4.957255 
diff Energy = 24.300281 
diff Energy = 25.890599 
diff Energy = 44.297334 
diff Energy = 15.220385 
diff Energy = 39.673352 
Finish ICM step! 
iter = 30, loglik= 108763208.000000, dloglik=0.000913 
37600.53 sec elapsed
**** Job ends ****
Thu Apr  6 23:54:26 EDT 2023
