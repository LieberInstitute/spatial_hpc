Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.1.x
**** Job starts ****
Wed Nov  2 15:12:17 EDT 2022
**** JHPCE info ****
User: mtippani
Job id: 621925
Job name: PRECAST_k16-20
Hostname: compute-095.cm.cluster
Task id: 16
Unloading conda_R/4.1.x
Loading conda_R/devel

The following have been reloaded with a version change:
  1) conda_R/4.1.x => conda_R/devel


Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.6.14
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/devel
  5) gcc/4.4.7        10) git-lfs/2.8.0

 

Filter spots and features from Raw count data...
 
 
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Calculating gene variances
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Calculating feature variances of standardized and clipped values
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 5000
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Warning messages:
1: In FUN(newX[, i], ...) : There are p-values that are exactly 1!
2: In FUN(newX[, i], ...) : There are p-values that are exactly 1!
[[1]]
An object of class Seurat 
2000 features across 14143 samples within 1 assay 
Active assay: RNA (2000 features, 1397 variable features)

[[2]]
An object of class Seurat 
2000 features across 19678 samples within 1 assay 
Active assay: RNA (2000 features, 1541 variable features)

[[3]]
An object of class Seurat 
2000 features across 14104 samples within 1 assay 
Active assay: RNA (2000 features, 1447 variable features)

[[4]]
An object of class Seurat 
2000 features across 8662 samples within 1 assay 
Active assay: RNA (2000 features, 1374 variable features)

[[5]]
An object of class Seurat 
2000 features across 14390 samples within 1 assay 
Active assay: RNA (2000 features, 1495 variable features)

[[6]]
An object of class Seurat 
2000 features across 18709 samples within 1 assay 
Active assay: RNA (2000 features, 1159 variable features)

[[7]]
An object of class Seurat 
2000 features across 20614 samples within 1 assay 
Active assay: RNA (2000 features, 1612 variable features)

[[8]]
An object of class Seurat 
2000 features across 8389 samples within 1 assay 
Active assay: RNA (2000 features, 1200 variable features)

[[9]]
An object of class Seurat 
2000 features across 18041 samples within 1 assay 
Active assay: RNA (2000 features, 1385 variable features)

Neighbors were identified for 14143 out of 14143 spots.
Neighbors were identified for 19678 out of 19678 spots.
Neighbors were identified for 14104 out of 14104 spots.
Neighbors were identified for 8662 out of 8662 spots.
Neighbors were identified for 14390 out of 14390 spots.
Neighbors were identified for 18709 out of 18709 spots.
Neighbors were identified for 20611 out of 20614 spots.
Neighbors were identified for 8389 out of 8389 spots.
Neighbors were identified for 18038 out of 18041 spots.
Intergrative data info.: 9 samples, 2000 genes X 136730 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
diff Energy = 28.624997 
diff Energy = 37.530116 
diff Energy = 52.392343 
Finish ICM step! 
iter = 2, loglik= -69756856.000000, dloglik=0.967517 
predict Y and V! 
diff Energy = 10.735705 
diff Energy = 104.772831 
diff Energy = 38.927264 
diff Energy = 56.931346 
diff Energy = 114.952932 
diff Energy = 15.084352 
diff Energy = 56.525043 
diff Energy = 62.331534 
Finish ICM step! 
iter = 3, loglik= -68950560.000000, dloglik=0.011559 
predict Y and V! 
diff Energy = 271.670835 
diff Energy = 361.648446 
diff Energy = 261.133029 
diff Energy = 230.280439 
diff Energy = 365.035070 
diff Energy = 15.172445 
diff Energy = 398.946675 
diff Energy = 259.558443 
diff Energy = 521.908510 
Finish ICM step! 
iter = 4, loglik= -68647432.000000, dloglik=0.004396 
predict Y and V! 
diff Energy = 158.909731 
diff Energy = 166.937020 
diff Energy = 102.587972 
diff Energy = 111.596244 
diff Energy = 156.279791 
diff Energy = 191.948710 
diff Energy = 122.806233 
diff Energy = 151.520922 
Finish ICM step! 
iter = 5, loglik= -68475120.000000, dloglik=0.002510 
predict Y and V! 
diff Energy = 128.146293 
diff Energy = 110.322444 
diff Energy = 47.145237 
diff Energy = 89.337378 
diff Energy = 143.279670 
diff Energy = 12.844675 
diff Energy = 94.277613 
diff Energy = 81.629951 
diff Energy = 128.026819 
Finish ICM step! 
iter = 6, loglik= -68369720.000000, dloglik=0.001539 
predict Y and V! 
diff Energy = 67.898389 
diff Energy = 93.230766 
diff Energy = 34.091719 
diff Energy = 77.037827 
diff Energy = 83.383934 
diff Energy = 1.893253 
diff Energy = 136.746126 
diff Energy = 83.871862 
diff Energy = 132.030031 
Finish ICM step! 
iter = 7, loglik= -68300480.000000, dloglik=0.001013 
predict Y and V! 
diff Energy = 52.849894 
diff Energy = 31.763763 
diff Energy = 49.517634 
diff Energy = 32.797036 
diff Energy = 40.941720 
diff Energy = 4.840389 
diff Energy = 11.300077 
diff Energy = 37.202946 
diff Energy = 22.178005 
Finish ICM step! 
iter = 8, loglik= -68250488.000000, dloglik=0.000732 
predict Y and V! 
diff Energy = 37.264896 
diff Energy = 12.329904 
diff Energy = 43.599506 
diff Energy = 19.904446 
diff Energy = 48.648693 
diff Energy = 1.061020 
diff Energy = 2.692147 
diff Energy = 33.384678 
diff Energy = 3.475171 
Finish ICM step! 
iter = 9, loglik= -68213112.000000, dloglik=0.000548 
predict Y and V! 
diff Energy = 19.487296 
diff Energy = 11.350879 
diff Energy = 20.466057 
diff Energy = 6.376690 
diff Energy = 13.874716 
diff Energy = 15.398321 
diff Energy = 8.212200 
diff Energy = 13.517434 
diff Energy = 31.766804 
Finish ICM step! 
iter = 10, loglik= -68184688.000000, dloglik=0.000417 
predict Y and V! 
diff Energy = 5.407932 
diff Energy = 6.474015 
diff Energy = 63.136613 
diff Energy = 52.531263 
diff Energy = 27.431657 
diff Energy = 8.361419 
diff Energy = 5.344642 
diff Energy = 56.399991 
Finish ICM step! 
iter = 11, loglik= -68163216.000000, dloglik=0.000315 
predict Y and V! 
diff Energy = 17.952674 
diff Energy = 18.731860 
diff Energy = 16.851431 
diff Energy = 18.417369 
diff Energy = 28.785338 
diff Energy = 2.205309 
diff Energy = 26.688750 
diff Energy = 2.274140 
diff Energy = 13.512811 
Finish ICM step! 
iter = 12, loglik= -68146592.000000, dloglik=0.000244 
predict Y and V! 
diff Energy = 0.770953 
diff Energy = 64.335603 
diff Energy = 9.320969 
diff Energy = 18.464300 
diff Energy = 21.938078 
diff Energy = 1.721294 
diff Energy = 42.853473 
diff Energy = 47.064564 
Finish ICM step! 
iter = 13, loglik= -68132928.000000, dloglik=0.000201 
predict Y and V! 
diff Energy = 9.337635 
diff Energy = 3.865315 
diff Energy = 12.710894 
diff Energy = 5.575058 
diff Energy = 9.476981 
diff Energy = 2.916557 
diff Energy = 17.665965 
diff Energy = 13.840568 
diff Energy = 4.571485 
Finish ICM step! 
iter = 14, loglik= -68121768.000000, dloglik=0.000164 
predict Y and V! 
diff Energy = 13.724661 
diff Energy = 0.221585 
diff Energy = 2.859980 
diff Energy = 7.985540 
diff Energy = 1.689450 
diff Energy = 3.160890 
diff Energy = 5.029873 
diff Energy = 6.065939 
diff Energy = 8.026684 
Finish ICM step! 
iter = 15, loglik= -68112296.000000, dloglik=0.000139 
predict Y and V! 
diff Energy = 6.901300 
diff Energy = 6.014183 
diff Energy = 3.447958 
diff Energy = 7.437591 
diff Energy = 5.449479 
diff Energy = 0.360992 
diff Energy = 1.402045 
diff Energy = 17.186289 
diff Energy = 4.890086 
Finish ICM step! 
iter = 16, loglik= -68104272.000000, dloglik=0.000118 
predict Y and V! 
diff Energy = 28.628453 
diff Energy = 2.905823 
diff Energy = 6.975068 
diff Energy = 5.794233 
diff Energy = 4.957062 
diff Energy = 4.570173 
diff Energy = 7.297215 
diff Energy = 4.840608 
diff Energy = 5.869638 
Finish ICM step! 
iter = 17, loglik= -68097000.000000, dloglik=0.000107 
predict Y and V! 
diff Energy = 7.931058 
diff Energy = 5.193998 
diff Energy = 4.776281 
diff Energy = 5.624558 
diff Energy = 27.807917 
diff Energy = 1.078625 
diff Energy = 4.249440 
diff Energy = 21.062032 
diff Energy = 8.705500 
Finish ICM step! 
iter = 18, loglik= -68090704.000000, dloglik=0.000092 
predict Y and V! 
diff Energy = 9.422311 
diff Energy = 2.924924 
diff Energy = 14.868614 
diff Energy = 4.591822 
diff Energy = 15.165880 
diff Energy = 3.225559 
diff Energy = 13.599785 
diff Energy = 9.873747 
diff Energy = 22.404316 
Finish ICM step! 
iter = 19, loglik= -68084768.000000, dloglik=0.000087 
predict Y and V! 
diff Energy = 4.498899 
diff Energy = 1.596192 
diff Energy = 11.300261 
diff Energy = 4.622663 
diff Energy = 16.936071 
diff Energy = 0.296940 
diff Energy = 10.452978 
diff Energy = 15.923636 
diff Energy = 10.668229 
Finish ICM step! 
iter = 20, loglik= -68079096.000000, dloglik=0.000083 
predict Y and V! 
diff Energy = 5.183802 
diff Energy = 2.577804 
diff Energy = 10.006163 
diff Energy = 16.261355 
diff Energy = 34.144096 
diff Energy = 2.228469 
diff Energy = 11.573086 
diff Energy = 3.536202 
diff Energy = 2.610361 
Finish ICM step! 
iter = 21, loglik= -68073728.000000, dloglik=0.000079 
predict Y and V! 
diff Energy = 10.940183 
diff Energy = 3.297171 
diff Energy = 7.699185 
diff Energy = 8.737013 
diff Energy = 19.271412 
diff Energy = 30.684877 
diff Energy = 2.841999 
diff Energy = 26.010344 
Finish ICM step! 
iter = 22, loglik= -68068488.000000, dloglik=0.000077 
predict Y and V! 
diff Energy = 12.533996 
diff Energy = 15.473418 
diff Energy = 5.925680 
diff Energy = 11.580299 
diff Energy = 18.889779 
diff Energy = 17.045276 
diff Energy = 0.994119 
diff Energy = 7.992435 
Finish ICM step! 
iter = 23, loglik= -68062712.000000, dloglik=0.000085 
predict Y and V! 
diff Energy = 21.026559 
diff Energy = 8.070772 
diff Energy = 6.581910 
diff Energy = 7.304440 
diff Energy = 14.359621 
diff Energy = 0.855829 
diff Energy = 15.125069 
diff Energy = 4.214486 
diff Energy = 3.827939 
Finish ICM step! 
iter = 24, loglik= -68056640.000000, dloglik=0.000089 
predict Y and V! 
diff Energy = 23.745506 
diff Energy = 3.364108 
diff Energy = 8.875179 
diff Energy = 17.511856 
diff Energy = 17.480146 
diff Energy = 4.593543 
Finish ICM step! 
iter = 25, loglik= -68050240.000000, dloglik=0.000094 
predict Y and V! 
diff Energy = 16.403490 
diff Energy = 6.081589 
diff Energy = 4.520160 
diff Energy = 5.159005 
diff Energy = 6.399442 
diff Energy = 2.374133 
Finish ICM step! 
iter = 26, loglik= -68043768.000000, dloglik=0.000095 
predict Y and V! 
diff Energy = 17.462581 
diff Energy = 6.937417 
diff Energy = 4.370438 
diff Energy = 1.134011 
diff Energy = 9.620141 
diff Energy = 36.933418 
diff Energy = 24.238562 
diff Energy = 5.919719 
diff Energy = 14.315355 
Finish ICM step! 
iter = 27, loglik= -68036840.000000, dloglik=0.000102 
predict Y and V! 
diff Energy = 32.174396 
diff Energy = 0.620108 
diff Energy = 2.291778 
diff Energy = 1.657828 
diff Energy = 13.872390 
diff Energy = 0.627130 
diff Energy = 35.171635 
diff Energy = 1.652863 
diff Energy = 7.533657 
Finish ICM step! 
iter = 28, loglik= -68029864.000000, dloglik=0.000103 
predict Y and V! 
diff Energy = 24.502774 
diff Energy = 9.157578 
diff Energy = 3.782658 
diff Energy = 15.216741 
diff Energy = 35.732326 
diff Energy = 6.432440 
diff Energy = 7.584196 
Finish ICM step! 
iter = 29, loglik= -68022888.000000, dloglik=0.000103 
predict Y and V! 
diff Energy = 13.701390 
diff Energy = 0.968805 
diff Energy = 0.409862 
diff Energy = 4.568231 
diff Energy = 12.863240 
diff Energy = 1.701499 
diff Energy = 34.276298 
diff Energy = 7.879799 
diff Energy = 1.077222 
Finish ICM step! 
iter = 30, loglik= -68015576.000000, dloglik=0.000107 
18217.538 sec elapsed
**** Job ends ****
Wed Nov  2 20:26:42 EDT 2022
