**** Job starts ****
Thu Apr  6 13:02:18 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100763
Job name: PRECAST_k25-30
Hostname: compute-093.cm.cluster
Task id: 26
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
**** Job starts ****
Thu Apr  6 13:04:02 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100765
Job name: PRECAST_k25-30
Hostname: compute-099.cm.cluster
Task id: 26
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
Finish ICM step! 
iter = 2, loglik= 106505224.000000, dloglik=1.049595 
predict Y and V! 
diff Energy = 29.114211 
diff Energy = 23.835970 
Finish ICM step! 
iter = 3, loglik= 107192112.000000, dloglik=0.006449 
predict Y and V! 
diff Energy = 70.835233 
diff Energy = 269.517414 
diff Energy = 110.136858 
diff Energy = 12.327303 
diff Energy = 130.191924 
diff Energy = 84.144959 
diff Energy = 60.910015 
diff Energy = 77.348873 
diff Energy = 86.546295 
diff Energy = 206.923387 
Finish ICM step! 
iter = 4, loglik= 107449352.000000, dloglik=0.002400 
predict Y and V! 
diff Energy = 111.954614 
diff Energy = 299.643708 
diff Energy = 99.265909 
diff Energy = 10.427318 
diff Energy = 110.466591 
diff Energy = 124.522880 
diff Energy = 112.216598 
diff Energy = 100.416848 
diff Energy = 104.493830 
diff Energy = 342.697029 
Finish ICM step! 
iter = 5, loglik= 107568760.000000, dloglik=0.001111 
predict Y and V! 
diff Energy = 296.074465 
diff Energy = 403.697543 
diff Energy = 76.814010 
diff Energy = 70.183951 
diff Energy = 292.487934 
diff Energy = 139.246378 
diff Energy = 319.921193 
diff Energy = 190.300851 
diff Energy = 124.876583 
diff Energy = 259.168932 
Finish ICM step! 
iter = 6, loglik= 107637624.000000, dloglik=0.000640 
predict Y and V! 
diff Energy = 240.408199 
diff Energy = 322.896232 
diff Energy = 132.115162 
diff Energy = 72.965261 
diff Energy = 349.407578 
diff Energy = 232.997795 
diff Energy = 360.728787 
diff Energy = 234.013230 
diff Energy = 285.841265 
diff Energy = 387.360008 
Finish ICM step! 
iter = 7, loglik= 107682592.000000, dloglik=0.000418 
predict Y and V! 
diff Energy = 285.517008 
diff Energy = 290.113589 
diff Energy = 153.744312 
diff Energy = 78.570681 
diff Energy = 303.516151 
diff Energy = 293.522252 
diff Energy = 296.254566 
diff Energy = 192.579639 
diff Energy = 275.557095 
diff Energy = 391.185777 
Finish ICM step! 
iter = 8, loglik= 107715416.000000, dloglik=0.000305 
predict Y and V! 
diff Energy = 218.545322 
diff Energy = 472.402664 
diff Energy = 137.103527 
diff Energy = 66.896556 
diff Energy = 210.023175 
diff Energy = 453.169089 
diff Energy = 322.996923 
diff Energy = 185.994049 
diff Energy = 446.366860 
diff Energy = 513.938962 
Finish ICM step! 
iter = 9, loglik= 107742048.000000, dloglik=0.000247 
predict Y and V! 
diff Energy = 383.217048 
diff Energy = 257.653013 
diff Energy = 263.585008 
diff Energy = 97.324704 
diff Energy = 482.319191 
diff Energy = 295.994416 
diff Energy = 571.734648 
diff Energy = 326.070480 
diff Energy = 288.578861 
diff Energy = 336.864637 
Finish ICM step! 
iter = 10, loglik= 107766288.000000, dloglik=0.000225 
predict Y and V! 
diff Energy = 231.960950 
diff Energy = 502.994388 
diff Energy = 161.483452 
diff Energy = 230.939913 
diff Energy = 288.495188 
diff Energy = 558.781741 
diff Energy = 275.785840 
diff Energy = 181.855341 
diff Energy = 231.307628 
diff Energy = 612.799900 
Finish ICM step! 
iter = 11, loglik= 107790592.000000, dloglik=0.000226 
predict Y and V! 
diff Energy = 221.338370 
diff Energy = 199.643937 
diff Energy = 164.977362 
diff Energy = 106.452097 
diff Energy = 444.626858 
diff Energy = 344.731640 
diff Energy = 254.552507 
diff Energy = 155.310650 
diff Energy = 562.814189 
diff Energy = 236.243936 
Finish ICM step! 
iter = 12, loglik= 107816112.000000, dloglik=0.000237 
predict Y and V! 
diff Energy = 474.455690 
diff Energy = 148.906802 
diff Energy = 273.118021 
diff Energy = 118.720532 
diff Energy = 247.215233 
diff Energy = 270.731558 
diff Energy = 602.445788 
diff Energy = 267.237645 
diff Energy = 325.669257 
diff Energy = 483.318450 
Finish ICM step! 
iter = 13, loglik= 107843064.000000, dloglik=0.000250 
predict Y and V! 
diff Energy = 233.009569 
diff Energy = 189.941989 
diff Energy = 166.719124 
diff Energy = 262.565556 
diff Energy = 202.454866 
diff Energy = 481.323070 
diff Energy = 214.015313 
diff Energy = 104.577401 
diff Energy = 572.599012 
diff Energy = 244.204194 
Finish ICM step! 
iter = 14, loglik= 107873432.000000, dloglik=0.000282 
predict Y and V! 
diff Energy = 115.581113 
diff Energy = 432.301872 
diff Energy = 123.087729 
diff Energy = 152.725026 
diff Energy = 256.025396 
diff Energy = 165.288499 
diff Energy = 187.784351 
diff Energy = 132.655103 
diff Energy = 317.088324 
diff Energy = 192.022385 
Finish ICM step! 
iter = 15, loglik= 107907424.000000, dloglik=0.000315 
predict Y and V! 
diff Energy = 301.059193 
diff Energy = 90.989433 
diff Energy = 279.919264 
diff Energy = 135.188475 
diff Energy = 102.370570 
diff Energy = 340.110447 
diff Energy = 420.895094 
diff Energy = 139.882460 
diff Energy = 292.973994 
diff Energy = 153.336463 
Finish ICM step! 
iter = 16, loglik= 107945016.000000, dloglik=0.000348 
predict Y and V! 
diff Energy = 160.263337 
diff Energy = 148.558851 
diff Energy = 155.777171 
diff Energy = 166.821771 
diff Energy = 94.458748 
diff Energy = 104.346366 
diff Energy = 113.718598 
diff Energy = 65.434063 
diff Energy = 421.343577 
diff Energy = 230.771181 
Finish ICM step! 
iter = 17, loglik= 107986280.000000, dloglik=0.000382 
predict Y and V! 
diff Energy = 116.269515 
diff Energy = 112.982084 
diff Energy = 165.175475 
diff Energy = 38.225718 
diff Energy = 49.341212 
diff Energy = 116.482295 
diff Energy = 108.858686 
diff Energy = 36.732819 
diff Energy = 175.028268 
diff Energy = 95.167117 
Finish ICM step! 
iter = 18, loglik= 108029520.000000, dloglik=0.000400 
predict Y and V! 
diff Energy = 111.548440 
diff Energy = 59.607260 
diff Energy = 257.306999 
diff Energy = 48.583593 
diff Energy = 89.321142 
diff Energy = 54.817298 
diff Energy = 96.341845 
diff Energy = 22.399039 
diff Energy = 188.406102 
diff Energy = 68.391089 
Finish ICM step! 
iter = 19, loglik= 108072832.000000, dloglik=0.000401 
predict Y and V! 
diff Energy = 86.136600 
diff Energy = 55.503912 
diff Energy = 108.967832 
diff Energy = 65.769966 
diff Energy = 94.224273 
diff Energy = 59.607548 
diff Energy = 17.469659 
diff Energy = 128.797349 
diff Energy = 66.343891 
Finish ICM step! 
iter = 20, loglik= 108115648.000000, dloglik=0.000396 
predict Y and V! 
diff Energy = 178.405474 
diff Energy = 2.440213 
diff Energy = 61.031997 
diff Energy = 85.698835 
diff Energy = 37.189730 
diff Energy = 77.185595 
diff Energy = 83.162396 
diff Energy = 64.516858 
diff Energy = 105.054651 
diff Energy = 59.147293 
Finish ICM step! 
iter = 21, loglik= 108157912.000000, dloglik=0.000391 
predict Y and V! 
diff Energy = 30.737940 
diff Energy = 48.446289 
diff Energy = 95.223527 
diff Energy = 18.802713 
diff Energy = 45.184522 
diff Energy = 37.344366 
diff Energy = 92.197524 
diff Energy = 16.707726 
diff Energy = 151.194065 
diff Energy = 31.723091 
Finish ICM step! 
iter = 22, loglik= 108201080.000000, dloglik=0.000399 
predict Y and V! 
diff Energy = 24.564031 
diff Energy = 4.409573 
diff Energy = 16.581282 
diff Energy = 26.510179 
diff Energy = 86.742253 
diff Energy = 38.117452 
diff Energy = 41.522742 
diff Energy = 29.853583 
diff Energy = 1.603022 
diff Energy = 16.845626 
Finish ICM step! 
iter = 23, loglik= 108248952.000000, dloglik=0.000442 
predict Y and V! 
diff Energy = 27.180249 
diff Energy = 26.406351 
diff Energy = 19.634791 
diff Energy = 38.203159 
diff Energy = 21.551305 
diff Energy = 12.754420 
diff Energy = 174.191362 
diff Energy = 14.911941 
diff Energy = 38.489505 
diff Energy = 27.192222 
Finish ICM step! 
iter = 24, loglik= 108311160.000000, dloglik=0.000575 
predict Y and V! 
diff Energy = 30.592480 
diff Energy = 37.870181 
diff Energy = 41.459588 
diff Energy = 13.427114 
diff Energy = 46.583884 
diff Energy = 37.047451 
diff Energy = 47.733290 
diff Energy = 10.152002 
diff Energy = 46.680026 
diff Energy = 20.446184 
Finish ICM step! 
iter = 25, loglik= 108393736.000000, dloglik=0.000762 
predict Y and V! 
diff Energy = 40.612876 
diff Energy = 36.731747 
diff Energy = 0.070417 
diff Energy = 23.303101 
diff Energy = 33.208731 
diff Energy = 88.038969 
diff Energy = 46.415653 
diff Energy = 11.588941 
diff Energy = 53.793603 
diff Energy = 78.107643 
Finish ICM step! 
iter = 26, loglik= 108483912.000000, dloglik=0.000832 
predict Y and V! 
diff Energy = 30.897345 
diff Energy = 21.730024 
diff Energy = 16.631999 
diff Energy = 0.573456 
diff Energy = 7.445956 
diff Energy = 13.340961 
diff Energy = 36.825674 
diff Energy = 15.001025 
diff Energy = 30.681587 
diff Energy = 11.309509 
Finish ICM step! 
iter = 27, loglik= 108571616.000000, dloglik=0.000808 
predict Y and V! 
diff Energy = 21.561537 
diff Energy = 36.487845 
diff Energy = 37.458956 
diff Energy = 15.019850 
diff Energy = 14.370545 
diff Energy = 47.513692 
diff Energy = 49.337577 
diff Energy = 6.555942 
diff Energy = 39.301580 
diff Energy = 33.247154 
Finish ICM step! 
iter = 28, loglik= 108656616.000000, dloglik=0.000783 
predict Y and V! 
diff Energy = 25.184566 
diff Energy = 21.136724 
diff Energy = 30.014118 
diff Energy = 25.107085 
diff Energy = 27.914638 
diff Energy = 31.955850 
diff Energy = 29.178478 
diff Energy = 10.676536 
diff Energy = 35.574857 
diff Energy = 19.797667 
Finish ICM step! 
iter = 29, loglik= 108744064.000000, dloglik=0.000805 
predict Y and V! 
diff Energy = 19.871135 
diff Energy = 8.116859 
diff Energy = 0.073406 
diff Energy = 1.893627 
diff Energy = 13.368245 
diff Energy = 4.930908 
diff Energy = 5.017816 
diff Energy = 57.153058 
diff Energy = 29.761346 
Finish ICM step! 
iter = 30, loglik= 108843880.000000, dloglik=0.000918 
29541.358 sec elapsed
**** Job ends ****
Thu Apr  6 21:37:35 EDT 2023
