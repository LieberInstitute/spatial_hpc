**** Job starts ****
Thu May 18 18:43:21 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3172459
Job name: sparkx_PRECAST_k15-20
Hostname: compute-065.cm.cluster
Task id: 16
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

**** Job starts ****
Thu May 18 22:58:11 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3172462
Job name: sparkx_PRECAST_k15-20
Hostname: compute-124.cm.cluster
Task id: 16
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
diff Energy = 40.134147 
Finish ICM step! 
iter = 2, loglik= 106496592.000000, dloglik=1.049591 
predict Y and V! 
diff Energy = 29.842082 
diff Energy = 14.273977 
diff Energy = 62.853811 
diff Energy = 101.854260 
diff Energy = 35.358457 
diff Energy = 0.590924 
diff Energy = 22.933995 
Finish ICM step! 
iter = 3, loglik= 107178448.000000, dloglik=0.006403 
predict Y and V! 
diff Energy = 113.954626 
diff Energy = 119.917337 
diff Energy = 48.334557 
diff Energy = 53.685618 
diff Energy = 143.243469 
diff Energy = 174.149829 
diff Energy = 138.590093 
diff Energy = 26.475054 
diff Energy = 156.591477 
diff Energy = 90.248688 
Finish ICM step! 
iter = 4, loglik= 107435640.000000, dloglik=0.002400 
predict Y and V! 
diff Energy = 195.759787 
diff Energy = 193.624009 
diff Energy = 34.544448 
diff Energy = 16.590155 
diff Energy = 205.132873 
diff Energy = 210.409885 
diff Energy = 187.665126 
diff Energy = 129.887929 
diff Energy = 73.406110 
diff Energy = 170.356192 
Finish ICM step! 
iter = 5, loglik= 107552424.000000, dloglik=0.001087 
predict Y and V! 
diff Energy = 238.645386 
diff Energy = 236.964078 
diff Energy = 74.468011 
diff Energy = 44.193190 
diff Energy = 243.153843 
diff Energy = 325.296839 
diff Energy = 245.966759 
diff Energy = 131.969358 
diff Energy = 133.883765 
diff Energy = 233.456495 
Finish ICM step! 
iter = 6, loglik= 107621584.000000, dloglik=0.000643 
predict Y and V! 
diff Energy = 230.036594 
diff Energy = 185.399012 
diff Energy = 98.951297 
diff Energy = 42.122680 
diff Energy = 180.813364 
diff Energy = 292.108306 
diff Energy = 216.536791 
diff Energy = 106.267573 
diff Energy = 183.796446 
diff Energy = 255.832536 
Finish ICM step! 
iter = 7, loglik= 107666528.000000, dloglik=0.000418 
predict Y and V! 
diff Energy = 201.372512 
diff Energy = 314.274300 
diff Energy = 100.681435 
diff Energy = 54.759257 
diff Energy = 152.008148 
diff Energy = 252.776414 
diff Energy = 159.965561 
diff Energy = 87.668167 
diff Energy = 174.515417 
diff Energy = 209.703564 
Finish ICM step! 
iter = 8, loglik= 107698184.000000, dloglik=0.000294 
predict Y and V! 
diff Energy = 166.017951 
diff Energy = 137.739611 
diff Energy = 57.917168 
diff Energy = 47.389308 
diff Energy = 115.574378 
diff Energy = 184.983116 
diff Energy = 177.077751 
diff Energy = 71.128252 
diff Energy = 110.513833 
diff Energy = 173.088619 
Finish ICM step! 
iter = 9, loglik= 107723096.000000, dloglik=0.000231 
predict Y and V! 
diff Energy = 145.303280 
diff Energy = 150.258084 
diff Energy = 147.766365 
diff Energy = 42.712640 
diff Energy = 230.155272 
diff Energy = 178.629264 
diff Energy = 155.184664 
diff Energy = 154.318909 
diff Energy = 98.853402 
diff Energy = 116.883221 
Finish ICM step! 
iter = 10, loglik= 107744480.000000, dloglik=0.000199 
predict Y and V! 
diff Energy = 271.590453 
diff Energy = 310.472380 
diff Energy = 64.828219 
diff Energy = 43.408549 
diff Energy = 117.013710 
diff Energy = 172.777933 
diff Energy = 361.619455 
diff Energy = 59.738422 
diff Energy = 99.617252 
diff Energy = 164.109745 
Finish ICM step! 
iter = 11, loglik= 107764480.000000, dloglik=0.000186 
predict Y and V! 
diff Energy = 127.320063 
diff Energy = 121.858345 
diff Energy = 59.872250 
diff Energy = 115.286458 
diff Energy = 122.297213 
diff Energy = 160.058121 
diff Energy = 127.493027 
diff Energy = 30.222566 
diff Energy = 324.866248 
diff Energy = 301.974760 
Finish ICM step! 
iter = 12, loglik= 107784056.000000, dloglik=0.000182 
predict Y and V! 
diff Energy = 100.023306 
diff Energy = 117.900637 
diff Energy = 188.780504 
diff Energy = 40.539995 
diff Energy = 107.194574 
diff Energy = 344.756614 
diff Energy = 148.706200 
diff Energy = 68.705841 
diff Energy = 149.566984 
diff Energy = 158.240646 
Finish ICM step! 
iter = 13, loglik= 107803096.000000, dloglik=0.000177 
predict Y and V! 
diff Energy = 104.322465 
diff Energy = 127.096217 
diff Energy = 57.325411 
diff Energy = 14.724584 
diff Energy = 314.077414 
diff Energy = 170.603410 
diff Energy = 99.341318 
diff Energy = 42.954314 
diff Energy = 158.041375 
diff Energy = 137.986855 
Finish ICM step! 
iter = 14, loglik= 107822016.000000, dloglik=0.000176 
predict Y and V! 
diff Energy = 124.827889 
diff Energy = 114.180629 
diff Energy = 79.931781 
diff Energy = 23.142602 
diff Energy = 148.655846 
diff Energy = 135.475882 
diff Energy = 390.031849 
diff Energy = 189.175872 
diff Energy = 126.465488 
diff Energy = 135.239654 
Finish ICM step! 
iter = 15, loglik= 107840800.000000, dloglik=0.000174 
predict Y and V! 
diff Energy = 282.238152 
diff Energy = 330.141326 
diff Energy = 51.761536 
diff Energy = 20.827743 
diff Energy = 140.534322 
diff Energy = 132.905520 
diff Energy = 144.924169 
diff Energy = 74.460331 
diff Energy = 122.276181 
diff Energy = 344.788497 
Finish ICM step! 
iter = 16, loglik= 107859896.000000, dloglik=0.000177 
predict Y and V! 
diff Energy = 107.079817 
diff Energy = 114.220247 
diff Energy = 37.815941 
diff Energy = 127.367247 
diff Energy = 128.439038 
diff Energy = 161.558627 
diff Energy = 124.648471 
diff Energy = 77.069575 
diff Energy = 342.197198 
diff Energy = 143.566831 
Finish ICM step! 
iter = 17, loglik= 107879784.000000, dloglik=0.000184 
predict Y and V! 
diff Energy = 111.274952 
diff Energy = 128.760672 
diff Energy = 69.883215 
diff Energy = 74.273820 
diff Energy = 308.281138 
diff Energy = 355.308735 
diff Energy = 121.436422 
diff Energy = 76.487430 
diff Energy = 173.424922 
diff Energy = 166.665886 
Finish ICM step! 
iter = 18, loglik= 107899864.000000, dloglik=0.000186 
predict Y and V! 
diff Energy = 124.772880 
diff Energy = 121.118305 
diff Energy = 213.931890 
diff Energy = 57.362751 
diff Energy = 123.362023 
diff Energy = 147.089556 
diff Energy = 152.342172 
diff Energy = 226.785978 
diff Energy = 158.231300 
diff Energy = 98.565882 
Finish ICM step! 
iter = 19, loglik= 107920496.000000, dloglik=0.000191 
predict Y and V! 
diff Energy = 112.345455 
diff Energy = 91.021510 
diff Energy = 58.181363 
diff Energy = 76.207875 
diff Energy = 136.037657 
diff Energy = 154.065533 
diff Energy = 404.049115 
diff Energy = 49.402255 
diff Energy = 153.133351 
diff Energy = 74.861580 
Finish ICM step! 
iter = 20, loglik= 107941960.000000, dloglik=0.000199 
predict Y and V! 
diff Energy = 311.090528 
diff Energy = 113.185388 
diff Energy = 59.435316 
diff Energy = 66.743557 
diff Energy = 73.851787 
diff Energy = 135.763660 
diff Energy = 120.369219 
diff Energy = 72.187225 
diff Energy = 164.599903 
diff Energy = 261.249432 
Finish ICM step! 
iter = 21, loglik= 107964904.000000, dloglik=0.000213 
predict Y and V! 
diff Energy = 84.876936 
diff Energy = 66.422497 
diff Energy = 95.832995 
diff Energy = 226.659372 
diff Energy = 7.042682 
diff Energy = 296.348669 
diff Energy = 136.024294 
diff Energy = 79.984259 
diff Energy = 375.801730 
diff Energy = 97.307239 
Finish ICM step! 
iter = 22, loglik= 107990576.000000, dloglik=0.000238 
predict Y and V! 
diff Energy = 138.366234 
diff Energy = 63.640027 
diff Energy = 56.893917 
diff Energy = 98.802265 
diff Energy = 59.756766 
diff Energy = 126.654148 
diff Energy = 117.661626 
diff Energy = 61.053110 
diff Energy = 136.995185 
diff Energy = 97.884268 
Finish ICM step! 
iter = 23, loglik= 108020728.000000, dloglik=0.000279 
predict Y and V! 
diff Energy = 109.586263 
diff Energy = 51.788853 
diff Energy = 96.444243 
diff Energy = 90.055579 
diff Energy = 20.000137 
diff Energy = 86.543808 
diff Energy = 86.760835 
diff Energy = 36.865679 
diff Energy = 166.430872 
diff Energy = 56.478105 
Finish ICM step! 
iter = 24, loglik= 108056304.000000, dloglik=0.000329 
predict Y and V! 
diff Energy = 43.497470 
diff Energy = 20.789833 
diff Energy = 26.947158 
diff Energy = 106.276983 
diff Energy = 20.981315 
diff Energy = 21.373986 
diff Energy = 55.975118 
diff Energy = 13.348955 
diff Energy = 29.112917 
diff Energy = 37.296744 
Finish ICM step! 
iter = 25, loglik= 108099624.000000, dloglik=0.000401 
predict Y and V! 
diff Energy = 41.106942 
diff Energy = 30.029068 
diff Energy = 201.173066 
diff Energy = 2.830296 
diff Energy = 93.773173 
diff Energy = 5.499080 
diff Energy = 32.504994 
diff Energy = 54.216163 
diff Energy = 24.410505 
Finish ICM step! 
iter = 26, loglik= 108153072.000000, dloglik=0.000494 
predict Y and V! 
diff Energy = 118.795401 
diff Energy = 13.119242 
diff Energy = 80.447625 
diff Energy = 123.015393 
diff Energy = 12.643288 
diff Energy = 3.393738 
diff Energy = 18.547505 
diff Energy = 47.018479 
Finish ICM step! 
iter = 27, loglik= 108222784.000000, dloglik=0.000645 
predict Y and V! 
diff Energy = 43.454019 
diff Energy = 6.665465 
diff Energy = 51.576867 
diff Energy = 0.330251 
diff Energy = 22.041976 
diff Energy = 4.660289 
diff Energy = 57.693891 
diff Energy = 0.928497 
diff Energy = 36.031550 
diff Energy = 32.117189 
Finish ICM step! 
iter = 28, loglik= 108313872.000000, dloglik=0.000842 
predict Y and V! 
diff Energy = 25.717566 
diff Energy = 15.593117 
diff Energy = 7.635030 
diff Energy = 15.590856 
diff Energy = 39.685952 
diff Energy = 13.421797 
diff Energy = 46.074087 
diff Energy = 10.040802 
diff Energy = 98.258424 
diff Energy = 30.797359 
Finish ICM step! 
iter = 29, loglik= 108415712.000000, dloglik=0.000940 
predict Y and V! 
diff Energy = 31.911256 
diff Energy = 14.571230 
diff Energy = 2.599475 
diff Energy = 0.231062 
diff Energy = 1.235504 
diff Energy = 25.184065 
diff Energy = 29.331918 
diff Energy = 11.225875 
diff Energy = 33.434835 
diff Energy = 5.563940 
Finish ICM step! 
iter = 30, loglik= 108514312.000000, dloglik=0.000909 
9255.541 sec elapsed
**** Job ends ****
Fri May 19 01:43:19 EDT 2023
