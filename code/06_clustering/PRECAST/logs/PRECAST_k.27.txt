**** Job starts ****
Thu Apr  6 13:02:18 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100763
Job name: PRECAST_k25-30
Hostname: compute-099.cm.cluster
Task id: 27
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

**** Job starts ****
Thu Apr  6 13:04:02 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3100765
Job name: PRECAST_k25-30
Hostname: compute-093.cm.cluster
Task id: 27
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
Finish ICM step! 
iter = 2, loglik= 106506672.000000, dloglik=1.049596 
predict Y and V! 
diff Energy = 2.917493 
Finish ICM step! 
iter = 3, loglik= 107193064.000000, dloglik=0.006445 
predict Y and V! 
diff Energy = 95.004086 
diff Energy = 207.976802 
diff Energy = 64.859579 
diff Energy = 38.676469 
diff Energy = 89.869497 
diff Energy = 130.416959 
diff Energy = 111.862642 
diff Energy = 56.499879 
diff Energy = 150.586331 
diff Energy = 168.758258 
Finish ICM step! 
iter = 4, loglik= 107450536.000000, dloglik=0.002402 
predict Y and V! 
diff Energy = 153.139291 
diff Energy = 308.492870 
diff Energy = 38.036590 
diff Energy = 143.198645 
diff Energy = 149.537945 
diff Energy = 140.510025 
diff Energy = 59.224656 
diff Energy = 140.604304 
diff Energy = 157.934334 
Finish ICM step! 
iter = 5, loglik= 107570224.000000, dloglik=0.001114 
predict Y and V! 
diff Energy = 231.662624 
diff Energy = 412.966932 
diff Energy = 91.375068 
diff Energy = 47.205377 
diff Energy = 315.126930 
diff Energy = 126.998914 
diff Energy = 144.148652 
diff Energy = 71.620988 
diff Energy = 199.148330 
diff Energy = 209.152624 
Finish ICM step! 
iter = 6, loglik= 107639584.000000, dloglik=0.000645 
predict Y and V! 
diff Energy = 219.039991 
diff Energy = 343.316638 
diff Energy = 112.565535 
diff Energy = 104.509673 
diff Energy = 338.002664 
diff Energy = 261.917596 
diff Energy = 326.800162 
diff Energy = 150.289805 
diff Energy = 286.509741 
diff Energy = 273.623970 
Finish ICM step! 
iter = 7, loglik= 107683992.000000, dloglik=0.000413 
predict Y and V! 
diff Energy = 205.785179 
diff Energy = 351.418732 
diff Energy = 111.752606 
diff Energy = 112.629909 
diff Energy = 267.915819 
diff Energy = 219.822862 
diff Energy = 529.357807 
diff Energy = 290.132044 
diff Energy = 253.561887 
diff Energy = 276.662796 
Finish ICM step! 
iter = 8, loglik= 107716336.000000, dloglik=0.000300 
predict Y and V! 
diff Energy = 213.641394 
diff Energy = 510.372069 
diff Energy = 127.857713 
diff Energy = 157.573269 
diff Energy = 290.916573 
diff Energy = 281.066247 
diff Energy = 322.911494 
diff Energy = 161.835376 
diff Energy = 541.446210 
diff Energy = 473.475675 
Finish ICM step! 
iter = 9, loglik= 107742576.000000, dloglik=0.000244 
predict Y and V! 
diff Energy = 208.468976 
diff Energy = 290.356148 
diff Energy = 244.744875 
diff Energy = 108.919175 
diff Energy = 489.541080 
diff Energy = 526.178229 
diff Energy = 347.427088 
diff Energy = 135.806940 
diff Energy = 259.066609 
diff Energy = 254.881978 
Finish ICM step! 
iter = 10, loglik= 107766752.000000, dloglik=0.000224 
predict Y and V! 
diff Energy = 363.052383 
diff Energy = 262.769092 
diff Energy = 141.008342 
diff Energy = 107.978147 
diff Energy = 262.154698 
diff Energy = 289.994362 
diff Energy = 590.732270 
diff Energy = 312.120684 
diff Energy = 257.855320 
diff Energy = 553.460837 
Finish ICM step! 
iter = 11, loglik= 107790232.000000, dloglik=0.000218 
predict Y and V! 
diff Energy = 187.308968 
diff Energy = 454.332335 
diff Energy = 138.690709 
diff Energy = 202.647905 
diff Energy = 226.966139 
diff Energy = 530.289893 
diff Energy = 284.351683 
diff Energy = 162.835811 
diff Energy = 565.547866 
diff Energy = 281.824636 
Finish ICM step! 
iter = 12, loglik= 107814608.000000, dloglik=0.000226 
predict Y and V! 
diff Energy = 183.316447 
diff Energy = 217.466660 
diff Energy = 122.203537 
diff Energy = 139.328653 
diff Energy = 448.971917 
diff Energy = 369.775974 
diff Energy = 251.023314 
diff Energy = 252.398064 
diff Energy = 317.415527 
diff Energy = 238.462980 
Finish ICM step! 
iter = 13, loglik= 107840584.000000, dloglik=0.000241 
predict Y and V! 
diff Energy = 413.250368 
diff Energy = 189.824659 
diff Energy = 280.476842 
diff Energy = 138.677414 
diff Energy = 184.890265 
diff Energy = 245.968282 
diff Energy = 474.752307 
diff Energy = 129.903883 
diff Energy = 265.030954 
diff Energy = 432.556137 
Finish ICM step! 
iter = 14, loglik= 107868328.000000, dloglik=0.000257 
predict Y and V! 
diff Energy = 163.534536 
diff Energy = 127.737649 
diff Energy = 121.978189 
diff Energy = 244.193030 
diff Energy = 172.921848 
diff Energy = 380.066921 
diff Energy = 345.863071 
diff Energy = 122.277646 
diff Energy = 453.335890 
diff Energy = 167.437020 
Finish ICM step! 
iter = 15, loglik= 107898808.000000, dloglik=0.000283 
predict Y and V! 
diff Energy = 78.292507 
diff Energy = 334.488140 
diff Energy = 148.352415 
diff Energy = 155.409237 
diff Energy = 303.420094 
diff Energy = 196.425119 
diff Energy = 178.004404 
diff Energy = 93.973155 
diff Energy = 230.457931 
diff Energy = 159.748706 
Finish ICM step! 
iter = 16, loglik= 107932360.000000, dloglik=0.000311 
predict Y and V! 
diff Energy = 104.175085 
diff Energy = 185.773065 
diff Energy = 294.987354 
diff Energy = 215.324212 
diff Energy = 87.216999 
diff Energy = 109.687730 
diff Energy = 159.857018 
diff Energy = 184.372160 
diff Energy = 211.731048 
diff Energy = 111.757912 
Finish ICM step! 
iter = 17, loglik= 107968656.000000, dloglik=0.000336 
predict Y and V! 
diff Energy = 219.138736 
diff Energy = 149.290831 
diff Energy = 159.997542 
diff Energy = 48.674534 
diff Energy = 119.445258 
diff Energy = 256.267052 
diff Energy = 293.337412 
diff Energy = 71.316749 
diff Energy = 362.649354 
diff Energy = 236.758221 
Finish ICM step! 
iter = 18, loglik= 108007592.000000, dloglik=0.000361 
predict Y and V! 
diff Energy = 111.128271 
diff Energy = 91.656748 
diff Energy = 88.582857 
diff Energy = 77.835515 
diff Energy = 73.069484 
diff Energy = 81.449171 
diff Energy = 132.722161 
diff Energy = 28.790003 
diff Energy = 187.310705 
diff Energy = 123.158908 
Finish ICM step! 
iter = 19, loglik= 108048664.000000, dloglik=0.000380 
predict Y and V! 
diff Energy = 117.590743 
diff Energy = 42.517580 
diff Energy = 120.170155 
diff Energy = 52.614172 
diff Energy = 70.867903 
diff Energy = 143.616104 
diff Energy = 108.381675 
diff Energy = 45.671419 
diff Energy = 117.386565 
diff Energy = 98.600388 
Finish ICM step! 
iter = 20, loglik= 108089328.000000, dloglik=0.000376 
predict Y and V! 
diff Energy = 98.829682 
diff Energy = 95.352039 
diff Energy = 206.247994 
diff Energy = 17.272806 
diff Energy = 77.329112 
diff Energy = 126.816698 
diff Energy = 113.975634 
diff Energy = 42.700407 
diff Energy = 135.384902 
diff Energy = 71.570923 
Finish ICM step! 
iter = 21, loglik= 108129304.000000, dloglik=0.000370 
predict Y and V! 
diff Energy = 35.447663 
diff Energy = 62.501690 
diff Energy = 86.864992 
diff Energy = 2.560514 
diff Energy = 72.379879 
diff Energy = 87.135918 
diff Energy = 73.060880 
diff Energy = 33.230687 
diff Energy = 58.497853 
diff Energy = 72.011977 
Finish ICM step! 
iter = 22, loglik= 108170424.000000, dloglik=0.000380 
predict Y and V! 
diff Energy = 57.139718 
diff Energy = 39.843929 
diff Energy = 31.228568 
diff Energy = 48.324590 
diff Energy = 29.096216 
diff Energy = 92.218167 
diff Energy = 61.258655 
diff Energy = 19.754545 
diff Energy = 55.664428 
diff Energy = 41.887599 
Finish ICM step! 
iter = 23, loglik= 108215280.000000, dloglik=0.000415 
predict Y and V! 
diff Energy = 37.803734 
diff Energy = 85.461200 
diff Energy = 50.382320 
diff Energy = 36.325151 
diff Energy = 39.329097 
diff Energy = 49.764316 
diff Energy = 65.266098 
diff Energy = 40.165627 
diff Energy = 23.283426 
diff Energy = 53.856242 
Finish ICM step! 
iter = 24, loglik= 108271384.000000, dloglik=0.000518 
predict Y and V! 
diff Energy = 18.878742 
diff Energy = 61.236567 
diff Energy = 20.318009 
diff Energy = 33.650490 
diff Energy = 27.984642 
diff Energy = 48.053604 
diff Energy = 30.451876 
diff Energy = 50.925449 
diff Energy = 137.165595 
diff Energy = 33.351554 
Finish ICM step! 
iter = 25, loglik= 108348240.000000, dloglik=0.000710 
predict Y and V! 
diff Energy = 6.008243 
diff Energy = 57.776506 
diff Energy = 4.869157 
diff Energy = 71.191487 
diff Energy = 26.323351 
diff Energy = 31.321053 
diff Energy = 26.345784 
diff Energy = 15.428172 
diff Energy = 46.650980 
diff Energy = 25.661674 
Finish ICM step! 
iter = 26, loglik= 108437528.000000, dloglik=0.000824 
predict Y and V! 
diff Energy = 13.638424 
diff Energy = 38.192730 
diff Energy = 31.884183 
diff Energy = 33.670744 
diff Energy = 5.492190 
diff Energy = 25.957806 
diff Energy = 58.061675 
diff Energy = 19.450802 
diff Energy = 26.555680 
diff Energy = 28.400972 
Finish ICM step! 
iter = 27, loglik= 108525680.000000, dloglik=0.000813 
predict Y and V! 
diff Energy = 32.394810 
diff Energy = 2.314170 
diff Energy = 1.179177 
diff Energy = 23.299354 
diff Energy = 22.698968 
diff Energy = 13.743179 
diff Energy = 34.294139 
diff Energy = 16.239219 
diff Energy = 49.794848 
diff Energy = 9.164243 
Finish ICM step! 
iter = 28, loglik= 108609224.000000, dloglik=0.000770 
predict Y and V! 
diff Energy = 11.619235 
diff Energy = 19.968028 
diff Energy = 10.559047 
diff Energy = 1.287227 
diff Energy = 16.638825 
diff Energy = 38.750481 
diff Energy = 23.117006 
diff Energy = 0.323418 
diff Energy = 49.065323 
diff Energy = 18.419392 
Finish ICM step! 
iter = 29, loglik= 108696008.000000, dloglik=0.000799 
predict Y and V! 
diff Energy = 97.392712 
diff Energy = 2.370203 
diff Energy = 10.056333 
diff Energy = 11.742523 
diff Energy = 19.277389 
diff Energy = 41.558699 
diff Energy = 131.221851 
diff Energy = 12.240427 
diff Energy = 24.088246 
diff Energy = 5.895020 
Finish ICM step! 
iter = 30, loglik= 108791392.000000, dloglik=0.000878 
31675.768 sec elapsed
**** Job ends ****
Thu Apr  6 22:10:08 EDT 2023
