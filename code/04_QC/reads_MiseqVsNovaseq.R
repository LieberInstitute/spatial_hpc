# cd /dcs04/lieber/lcolladotor/spatialHPC_LIBD4035/spatial_hpc/
suppressPackageStartupMessages(library("here"))
suppressPackageStartupMessages(library("SpatialExperiment"))
suppressPackageStartupMessages(library("spatialLIBD"))

load(file = here::here("processed-data", "02_build_spe", "spe_basic.Rdata"))

spe$seq_type = "novaseq"
spe$seq_type[which(spe$slide == "V10B01-085")] = "miseq&novaseq"
spe$seq_type[which(spe$slide == "V10B01-086")] = "miseq&novaseq"

aggregate(spe$sum_umi,list(spe$sample_id), FUN = sum)
# Group.1        x
# 1  V10B01-085_A1 21422164
# 2  V10B01-085_B1 11036139
# 3  V10B01-085_C1 15663852
# 4  V10B01-085_D1 18549377
# 5  V10B01-086_A1 12524329
# 6  V10B01-086_B1  8760766
# 7  V10B01-086_C1  7249333
# 8  V10B01-086_D1  9768033
# 9  V11A20-297_A1 17081143
# 10 V11A20-297_B1 15809643
# 11 V11A20-297_C1  7697499
# 12 V11A20-297_D1  7532339
# 13 V11L05-333_A1 18855725
# 14 V11L05-333_B1 17998802
# 15 V11L05-333_C1 14504774
# 16 V11L05-333_D1 15266823
# 17 V11L05-335_A1  9331775
# 18 V11L05-335_B1 10834387
# 19 V11L05-335_C1 11535088
# 20 V11L05-335_D1  7731221
# 21 V11L05-336_A1 13414908
# 22 V11L05-336_B1 10577352
# 23 V11L05-336_C1  7449966
# 24 V11L05-336_D1  8751261
# 25 V11U08-081_A1  9898109
# 26 V11U08-081_B1 10436866
# 27 V11U08-081_C1 14503377
# 28 V11U08-081_D1 13889623
# 29 V11U08-084_A1 10881766
# 30 V11U08-084_B1  7683000
# 31 V11U08-084_C1 13570886
# 32 V11U08-084_D1 12094183

aggregate(spe$sum_gene,list(spe$sample_id), FUN = sum)
#   Group.1       x
# 1  V10B01-085_A1 9901010
# 2  V10B01-085_B1 5457058
# 3  V10B01-085_C1 7687442
# 4  V10B01-085_D1 8171269
# 5  V10B01-086_A1 6797687
# 6  V10B01-086_B1 4848484
# 7  V10B01-086_C1 3915899
# 8  V10B01-086_D1 5183521
# 9  V11A20-297_A1 8139310
# 10 V11A20-297_B1 7429691
# 11 V11A20-297_C1 4238401
# 12 V11A20-297_D1 4163864
# 13 V11L05-333_A1 9394499
# 14 V11L05-333_B1 8131897
# 15 V11L05-333_C1 7251651
# 16 V11L05-333_D1 7083374
# 17 V11L05-335_A1 5092197
# 18 V11L05-335_B1 5801527
# 19 V11L05-335_C1 6121103
# 20 V11L05-335_D1 4443307
# 21 V11L05-336_A1 6990738
# 22 V11L05-336_B1 5737767
# 23 V11L05-336_C1 4288735
# 24 V11L05-336_D1 4707505
# 25 V11U08-081_A1 5725051
# 26 V11U08-081_B1 5424572
# 27 V11U08-081_C1 7003385
# 28 V11U08-081_D1 7044640
# 29 V11U08-084_A1 5426025
# 30 V11U08-084_B1 3747883
# 31 V11U08-084_C1 6271668
# 32 V11U08-084_D1 4506482