**** Job starts ****
Fri May 19 04:54:08 EDT 2023
**** JHPCE info ****
User: enelson
Job id: 3172462
Job name: sparkx_PRECAST_k15-20
Hostname: compute-124.cm.cluster
Task id: 18
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV
  3) JHPCE_tools/1.0   8) conda/3-4.11.0
  4) sge/8.1.9         9) conda_R/4.2.x
  5) gcc/4.4.7

 

Filter spots and features from Raw count data...
 
 
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14172
## number of total genes: 25272
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 19762
## number of total genes: 26681
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14117
## number of total genes: 26452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8670
## number of total genes: 24039
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 14400
## number of total genes: 24894
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18746
## number of total genes: 25631
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 20693
## number of total genes: 26506
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 8390
## number of total genes: 24013
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 18159
## number of total genes: 25452
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Find the spatially variables genes by SPARK-X...

## ===== SPARK-X INPUT INFORMATION ====
## number of total samples: 15520
## number of total genes: 25019
## Running with single core, may take some time 

## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
## Testing With Cosine Kernel 5
Select common top variable genes  for multiple samples...
Filter spots and features from SVGs(HVGs) count data...
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
There were 16 warnings (use warnings() to see them)
[[1]]
An object of class Seurat 
2000 features across 14025 samples within 1 assay 
Active assay: RNA (2000 features, 454 variable features)

[[2]]
An object of class Seurat 
2000 features across 19307 samples within 1 assay 
Active assay: RNA (2000 features, 475 variable features)

[[3]]
An object of class Seurat 
2000 features across 14067 samples within 1 assay 
Active assay: RNA (2000 features, 478 variable features)

[[4]]
An object of class Seurat 
2000 features across 8636 samples within 1 assay 
Active assay: RNA (2000 features, 471 variable features)

[[5]]
An object of class Seurat 
2000 features across 14166 samples within 1 assay 
Active assay: RNA (2000 features, 461 variable features)

[[6]]
An object of class Seurat 
2000 features across 18363 samples within 1 assay 
Active assay: RNA (2000 features, 457 variable features)

[[7]]
An object of class Seurat 
2000 features across 20348 samples within 1 assay 
Active assay: RNA (2000 features, 504 variable features)

[[8]]
An object of class Seurat 
2000 features across 8349 samples within 1 assay 
Active assay: RNA (2000 features, 501 variable features)

[[9]]
An object of class Seurat 
2000 features across 17687 samples within 1 assay 
Active assay: RNA (2000 features, 497 variable features)

[[10]]
An object of class Seurat 
2000 features across 14881 samples within 1 assay 
Active assay: RNA (2000 features, 470 variable features)

Neighbors were identified for 14016 out of 14025 spots.
Neighbors were identified for 19294 out of 19307 spots.
Neighbors were identified for 14065 out of 14067 spots.
Neighbors were identified for 8636 out of 8636 spots.
Neighbors were identified for 14166 out of 14166 spots.
Neighbors were identified for 18360 out of 18363 spots.
Neighbors were identified for 20347 out of 20348 spots.
Neighbors were identified for 8349 out of 8349 spots.
Neighbors were identified for 17673 out of 17687 spots.
Neighbors were identified for 14878 out of 14881 spots.
Intergrative data info.: 10 samples, 2000 genes X 149829 spots------
PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
Finish ICM step! 
iter = 2, loglik= 106500680.000000, dloglik=1.049593 
predict Y and V! 
diff Energy = 0.796494 
diff Energy = 7.066557 
diff Energy = 54.625797 
diff Energy = 8.634150 
Finish ICM step! 
iter = 3, loglik= 107184792.000000, dloglik=0.006424 
predict Y and V! 
diff Energy = 118.155988 
diff Energy = 126.334555 
diff Energy = 81.227896 
diff Energy = 65.430812 
diff Energy = 103.488326 
diff Energy = 163.868557 
diff Energy = 201.697346 
diff Energy = 57.350822 
diff Energy = 98.142676 
diff Energy = 55.531823 
Finish ICM step! 
iter = 4, loglik= 107441152.000000, dloglik=0.002392 
predict Y and V! 
diff Energy = 130.575304 
diff Energy = 152.975366 
diff Energy = 33.449804 
diff Energy = 51.419457 
diff Energy = 25.301130 
diff Energy = 288.869424 
diff Energy = 54.410730 
diff Energy = 201.952599 
diff Energy = 38.095052 
Finish ICM step! 
iter = 5, loglik= 107557848.000000, dloglik=0.001086 
predict Y and V! 
diff Energy = 166.119549 
diff Energy = 220.075029 
diff Energy = 84.038408 
diff Energy = 16.816785 
diff Energy = 47.688907 
diff Energy = 30.529130 
diff Energy = 207.929032 
diff Energy = 55.182607 
diff Energy = 154.608106 
diff Energy = 104.449949 
Finish ICM step! 
iter = 6, loglik= 107626648.000000, dloglik=0.000640 
predict Y and V! 
diff Energy = 209.104967 
diff Energy = 198.520849 
diff Energy = 20.611089 
diff Energy = 57.013928 
diff Energy = 74.593749 
diff Energy = 100.999259 
diff Energy = 338.237535 
diff Energy = 79.223146 
diff Energy = 279.259303 
diff Energy = 122.465058 
Finish ICM step! 
iter = 7, loglik= 107669728.000000, dloglik=0.000400 
predict Y and V! 
diff Energy = 152.124856 
diff Energy = 178.378716 
diff Energy = 30.232897 
diff Energy = 40.825269 
diff Energy = 74.079674 
diff Energy = 64.980540 
diff Energy = 265.428756 
diff Energy = 62.202370 
diff Energy = 210.577422 
diff Energy = 133.847304 
Finish ICM step! 
iter = 8, loglik= 107699888.000000, dloglik=0.000280 
predict Y and V! 
diff Energy = 155.325089 
diff Energy = 149.534184 
diff Energy = 35.880802 
diff Energy = 40.537802 
diff Energy = 85.865724 
diff Energy = 84.363592 
diff Energy = 238.225292 
diff Energy = 72.759768 
diff Energy = 153.331250 
diff Energy = 122.546027 
Finish ICM step! 
iter = 9, loglik= 107723032.000000, dloglik=0.000215 
predict Y and V! 
diff Energy = 138.072922 
diff Energy = 324.925153 
diff Energy = 130.879531 
diff Energy = 30.323467 
diff Energy = 63.238252 
diff Energy = 61.133608 
diff Energy = 337.759131 
diff Energy = 65.309333 
diff Energy = 140.036535 
diff Energy = 116.050341 
Finish ICM step! 
iter = 10, loglik= 107742608.000000, dloglik=0.000182 
predict Y and V! 
diff Energy = 94.350302 
diff Energy = 159.251335 
diff Energy = 59.693820 
diff Energy = 29.502830 
diff Energy = 189.609818 
diff Energy = 177.879836 
diff Energy = 192.172407 
diff Energy = 135.906703 
diff Energy = 296.341101 
diff Energy = 111.871910 
Finish ICM step! 
iter = 11, loglik= 107760464.000000, dloglik=0.000166 
predict Y and V! 
diff Energy = 216.806104 
diff Energy = 119.390661 
diff Energy = 32.655714 
diff Energy = 98.901260 
diff Energy = 98.608988 
diff Energy = 52.495375 
diff Energy = 188.121877 
diff Energy = 27.742603 
diff Energy = 111.938739 
diff Energy = 82.132806 
Finish ICM step! 
iter = 12, loglik= 107777736.000000, dloglik=0.000160 
predict Y and V! 
diff Energy = 99.070074 
diff Energy = 113.720078 
diff Energy = 47.346521 
diff Energy = 31.298939 
diff Energy = 94.494089 
diff Energy = 14.204684 
diff Energy = 162.715779 
diff Energy = 65.402952 
diff Energy = 94.778356 
diff Energy = 74.710512 
Finish ICM step! 
iter = 13, loglik= 107794560.000000, dloglik=0.000156 
predict Y and V! 
diff Energy = 91.018736 
diff Energy = 342.057968 
diff Energy = 174.461566 
diff Energy = 28.665748 
diff Energy = 88.292873 
diff Energy = 56.296811 
diff Energy = 348.421025 
diff Energy = 35.576589 
diff Energy = 117.024348 
diff Energy = 221.118051 
Finish ICM step! 
iter = 14, loglik= 107811152.000000, dloglik=0.000154 
predict Y and V! 
diff Energy = 90.651040 
diff Energy = 126.962420 
diff Energy = 73.680877 
diff Energy = 23.732968 
diff Energy = 101.641522 
diff Energy = 27.566960 
diff Energy = 96.711367 
diff Energy = 42.392356 
diff Energy = 83.046099 
diff Energy = 105.602067 
Finish ICM step! 
iter = 15, loglik= 107828744.000000, dloglik=0.000163 
predict Y and V! 
diff Energy = 90.133136 
diff Energy = 151.524811 
diff Energy = 68.022232 
diff Energy = 46.387506 
diff Energy = 299.242608 
diff Energy = 179.737170 
diff Energy = 129.109060 
diff Energy = 32.387911 
diff Energy = 76.534615 
diff Energy = 60.675056 
Finish ICM step! 
iter = 16, loglik= 107846176.000000, dloglik=0.000162 
predict Y and V! 
diff Energy = 259.716274 
diff Energy = 119.352927 
diff Energy = 56.135077 
diff Energy = 23.274399 
diff Energy = 149.873680 
diff Energy = 47.679114 
diff Energy = 164.251603 
diff Energy = 29.739164 
diff Energy = 312.143244 
diff Energy = 70.113054 
Finish ICM step! 
iter = 17, loglik= 107863672.000000, dloglik=0.000162 
predict Y and V! 
diff Energy = 141.303090 
diff Energy = 127.506194 
diff Energy = 95.006090 
diff Energy = 133.789316 
diff Energy = 154.018668 
diff Energy = 57.525868 
diff Energy = 106.686625 
diff Energy = 145.763968 
diff Energy = 97.219285 
diff Energy = 92.165025 
Finish ICM step! 
iter = 18, loglik= 107881104.000000, dloglik=0.000162 
predict Y and V! 
diff Energy = 133.475283 
diff Energy = 94.680703 
diff Energy = 233.103527 
diff Energy = 50.797330 
diff Energy = 161.047386 
diff Energy = 62.082742 
diff Energy = 434.210405 
diff Energy = 49.903093 
diff Energy = 119.660123 
diff Energy = 88.991569 
Finish ICM step! 
iter = 19, loglik= 107898144.000000, dloglik=0.000158 
predict Y and V! 
diff Energy = 111.182828 
diff Energy = 388.448812 
diff Energy = 76.079415 
diff Energy = 59.920503 
diff Energy = 320.660390 
diff Energy = 55.603060 
diff Energy = 169.076120 
diff Energy = 56.929305 
diff Energy = 143.080449 
diff Energy = 262.310134 
Finish ICM step! 
iter = 20, loglik= 107915192.000000, dloglik=0.000158 
predict Y and V! 
diff Energy = 154.916677 
diff Energy = 74.767303 
diff Energy = 94.992762 
diff Energy = 38.278138 
diff Energy = 149.934143 
diff Energy = 94.189177 
diff Energy = 178.828656 
diff Energy = 73.300699 
diff Energy = 148.156532 
diff Energy = 116.445822 
Finish ICM step! 
iter = 21, loglik= 107933248.000000, dloglik=0.000167 
predict Y and V! 
diff Energy = 366.339566 
diff Energy = 89.080284 
diff Energy = 64.464211 
diff Energy = 52.724513 
diff Energy = 149.817684 
diff Energy = 219.872345 
diff Energy = 166.527286 
diff Energy = 78.998264 
diff Energy = 428.657852 
diff Energy = 102.589082 
Finish ICM step! 
iter = 22, loglik= 107953328.000000, dloglik=0.000186 
predict Y and V! 
diff Energy = 178.916416 
diff Energy = 67.233227 
diff Energy = 66.070877 
diff Energy = 79.115607 
diff Energy = 96.850023 
diff Energy = 80.291611 
diff Energy = 150.406043 
diff Energy = 219.163362 
diff Energy = 242.222874 
diff Energy = 115.612858 
Finish ICM step! 
iter = 23, loglik= 107978576.000000, dloglik=0.000234 
predict Y and V! 
diff Energy = 125.825404 
diff Energy = 68.559615 
diff Energy = 272.975358 
diff Energy = 178.049043 
diff Energy = 250.796519 
diff Energy = 96.182063 
diff Energy = 358.424062 
diff Energy = 97.972933 
diff Energy = 207.577849 
diff Energy = 368.948517 
Finish ICM step! 
iter = 24, loglik= 108012360.000000, dloglik=0.000313 
predict Y and V! 
diff Energy = 145.706968 
diff Energy = 46.154349 
diff Energy = 126.509868 
diff Energy = 100.507746 
diff Energy = 23.337847 
diff Energy = 159.151116 
diff Energy = 16.403705 
diff Energy = 119.174068 
diff Energy = 231.135327 
diff Energy = 179.903304 
Finish ICM step! 
iter = 25, loglik= 108062168.000000, dloglik=0.000461 
predict Y and V! 
diff Energy = 280.145713 
diff Energy = 35.472635 
diff Energy = 148.347132 
diff Energy = 100.295492 
diff Energy = 59.895488 
diff Energy = 143.541617 
diff Energy = 112.778710 
diff Energy = 162.094334 
diff Energy = 471.283465 
diff Energy = 122.223124 
Finish ICM step! 
iter = 26, loglik= 108135192.000000, dloglik=0.000676 
predict Y and V! 
diff Energy = 94.480798 
diff Energy = 28.241868 
diff Energy = 63.737024 
diff Energy = 129.582147 
diff Energy = 37.532563 
diff Energy = 386.529521 
diff Energy = 101.594348 
diff Energy = 67.176135 
diff Energy = 118.309190 
diff Energy = 36.259954 
Finish ICM step! 
iter = 27, loglik= 108230064.000000, dloglik=0.000877 
predict Y and V! 
diff Energy = 64.853367 
diff Energy = 38.454258 
diff Energy = 85.591825 
diff Energy = 187.701626 
diff Energy = 18.797984 
diff Energy = 253.737300 
diff Energy = 68.874358 
diff Energy = 9.062315 
diff Energy = 34.148426 
diff Energy = 159.779448 
Finish ICM step! 
iter = 28, loglik= 108334304.000000, dloglik=0.000963 
predict Y and V! 
diff Energy = 75.274607 
diff Energy = 3.697481 
diff Energy = 185.385529 
diff Energy = 19.909840 
diff Energy = 18.187815 
diff Energy = 171.923266 
diff Energy = 45.573003 
diff Energy = 1.589002 
diff Energy = 65.051408 
diff Energy = 7.467959 
Finish ICM step! 
iter = 29, loglik= 108447960.000000, dloglik=0.001049 
predict Y and V! 
diff Energy = 52.448909 
diff Energy = 43.624286 
diff Energy = 31.568511 
diff Energy = 27.543639 
diff Energy = 147.931053 
diff Energy = 36.982540 
diff Energy = 1.367008 
diff Energy = 20.692061 
diff Energy = 27.767794 
Finish ICM step! 
iter = 30, loglik= 108577608.000000, dloglik=0.001195 
12579.321 sec elapsed
**** Job ends ****
Fri May 19 08:34:36 EDT 2023
