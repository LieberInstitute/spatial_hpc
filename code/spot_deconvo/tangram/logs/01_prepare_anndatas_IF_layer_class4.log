Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.1.x
**** Job starts ****
Mon Oct  2 12:24:20 EDT 2023
**** JHPCE info ****
User: mtippani
Job id: 3748981
Job name: prepare_anndatas_HE
Hostname: compute-126.cm.cluster
Task id: 4
Loading LIBD module for tangram/1.0.2
INFO:root:489 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:25491 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
Loading AnnDatas...
Subsetting to just sample V12D07-332_B1.
Gene ENSG00000198162 (PPFIA2) is in the test set.
Gene ENSG00000168314 (AMPH) is in the training set.
Gene ENSG00000145423 (FNDC1) is in the test set.
Gene ENSG00000164241 (GFRA1) is in the test set.
Gene ENSG00000164434 (KRT17) is in the training set.
Gene ENSG00000164694 (C5orf63) is in the training set.
Gene ENSG00000180354 (GAD2) is in the test set.
Gene ENSG00000078053 (MIF) is in the test set.
Gene ENSG00000136750 (FABP7) is in the test set.
Gene ENSG00000107796 (MAN1A2) is in the test set.
Gene ENSG00000151892 (SFRP2) is in the training set.
Gene ENSG00000019144 (MOBP) is in the test set.
Gene ENSG00000139220 (MAG) is in the test set.
Gene ENSG00000128422 (MTURN) is in the test set.
Gene ENSG00000118271 (PHLDB1) is in the test set.
Gene ENSG00000105695 (ACTA2) is in the training set.
Gene ENSG00000240972 (TTR) is in the test set.
Traceback (most recent call last):
  File "/jhpce/shared/jhpce/libd/tangram/1.0.2/tangram_env/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'PRECAST_k18_nnSVG'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "01_prepare_anndata_HE.py", line 130, in <module>
    ad_sp.obs[cluster_var_plots] = ad_sp.obs[cluster_var_plots].astype('category')
  File "/jhpce/shared/jhpce/libd/tangram/1.0.2/tangram_env/lib/python3.8/site-packages/pandas/core/frame.py", line 3024, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/jhpce/shared/jhpce/libd/tangram/1.0.2/tangram_env/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3082, in get_loc
    raise KeyError(key) from err
KeyError: 'PRECAST_k18_nnSVG'
**** Job ends ****
Mon Oct  2 12:24:44 EDT 2023
Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.1.x
**** Job starts ****
Mon Oct  2 13:11:07 EDT 2023
**** JHPCE info ****
User: mtippani
Job id: 3748985
Job name: prepare_anndatas_HE
Hostname: compute-126.cm.cluster
Task id: 4
Loading LIBD module for tangram/1.0.2
INFO:root:489 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:25491 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
Loading AnnDatas...
Subsetting to just sample V12D07-332_B1.
Gene ENSG00000198162 (PPFIA2) is in the test set.
Gene ENSG00000168314 (AMPH) is in the training set.
Gene ENSG00000145423 (FNDC1) is in the test set.
Gene ENSG00000164241 (GFRA1) is in the test set.
Gene ENSG00000164434 (KRT17) is in the training set.
Gene ENSG00000164694 (C5orf63) is in the training set.
Gene ENSG00000180354 (GAD2) is in the test set.
Gene ENSG00000078053 (MIF) is in the test set.
Gene ENSG00000136750 (FABP7) is in the test set.
Gene ENSG00000107796 (MAN1A2) is in the test set.
Gene ENSG00000151892 (SFRP2) is in the training set.
Gene ENSG00000019144 (MOBP) is in the test set.
Gene ENSG00000139220 (MAG) is in the test set.
Gene ENSG00000128422 (MTURN) is in the test set.
Gene ENSG00000118271 (PHLDB1) is in the test set.
Gene ENSG00000105695 (ACTA2) is in the training set.
Gene ENSG00000240972 (TTR) is in the test set.
**** Job ends ****
Mon Oct  2 13:11:55 EDT 2023
Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.1.x
**** Job starts ****
Wed Oct  4 15:32:25 EDT 2023
**** JHPCE info ****
User: mtippani
Job id: 3750156
Job name: prepare_anndatas_HE
Hostname: compute-126.cm.cluster
Task id: 4
Loading LIBD module for tangram/1.0.2
INFO:root:489 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:25491 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
Loading AnnDatas...
Subsetting to just sample V12D07-332_B1.
Gene ENSG00000198162 (PPFIA2) is in the test set.
Gene ENSG00000168314 (AMPH) is in the training set.
Gene ENSG00000145423 (FNDC1) is in the test set.
Gene ENSG00000164241 (GFRA1) is in the test set.
Gene ENSG00000164434 (KRT17) is in the training set.
Gene ENSG00000164694 (C5orf63) is in the training set.
Gene ENSG00000180354 (GAD2) is in the test set.
Gene ENSG00000078053 (MIF) is in the test set.
Gene ENSG00000136750 (FABP7) is in the test set.
Gene ENSG00000107796 (MAN1A2) is in the test set.
Gene ENSG00000151892 (SFRP2) is in the training set.
Gene ENSG00000019144 (MOBP) is in the test set.
Gene ENSG00000139220 (MAG) is in the test set.
Gene ENSG00000128422 (MTURN) is in the test set.
Gene ENSG00000118271 (PHLDB1) is in the test set.
Gene ENSG00000105695 (ACTA2) is in the training set.
Gene ENSG00000240972 (TTR) is in the test set.
**** Job ends ****
Wed Oct  4 15:35:02 EDT 2023
